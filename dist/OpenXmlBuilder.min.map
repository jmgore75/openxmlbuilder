{"version":3,"file":"OpenXmlBuilder.min.js","sources":["OpenXmlBuilder.js"],"names":["window","undefined","nsResolver","pref","ox","nameNS","name","rootNs","r","full","ns","oxNs","toks","split","length","use","docTemplate","t","xmlDoctype","arguments","i","openXmlISOString","date","pad2","number","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","nodeWrap","nodes","push","XNode","node","this","XDoc","xmlStr","charCodeAt","substring","doc","xhelp","makeDoc","root","getAttr","XPart","xpkg","contentType","path","relsXmlStr","idx","lastIndexOf","relsPath","slice","xdoc","relsXdoc","f","zip","file","asText","XPkg","b64Template","title","created","creator","JSZip","base64","checkCRC32","parts","Date","ctDoc","core","getPart","one","setValue","titleElement","add","el","leftPad","s","len","c","convertColor","tem","toString","toUpperCase","test","A","substr","colornames","match","indexOf","Math","round","parseFloat","parseInt","join","convertStyle","a","verticalAlign","sup","sub","fontWeight","isNaN","b","fontStyle","textDecoration","u","color","backgroundColor","bgColor","Blocker","blocks","block","cleanupHtml","html","replace","convertHtml","d","document","createElement","p","head","body","appendChild","innerHTML","mblocker","procNodes","childNodes","removeChild","getBlocks","PPTXBuilder","call","presentation","sldIdLst","slideCount","all","app","slidesProp","slidesTitlesProp","titlesVector","removeAllSlides","slideLayouts","_findLayouts","_valBuild","e","v","w:val","DOCXBuilder","sectPr","es","remove","rStyles","pStyles","Italic","rStyleItalic","Bold","rStyleBold","Underline","rStyleUnderline","styles","styleType","styleId","undoPart","OpenXmlBuilder","version","xmlns","rel","vt","dcterms","dc","cp","ep","w","ct","selNs","abbrev","hasOwnProperty","relTypes","relTypePrefix","hyperlink","contTypes","relsTemplate","EGHelper","DOMParser","parseFromString","makeEl","tag","createElementNS","toXml","XMLSerializer","serializeToString","xpath","first","ownerDocument","evaluate","XPathResult","FIRST_ORDERED_NODE_TYPE","singleNodeValue","rs","ORDERED_NODE_SNAPSHOT_TYPE","snapshotLength","snapshotItem","setNs","setAttributeNS","IEHelper","ActiveXObject","async","loadXML","setProperty","createNode","xml","selectSingleNode","selectNodes","value","setAttributeNode","XMLHelper","prototype","parentNode","nodeType","firstChild","txt","createTextNode","getValue","nodeValue","setAttr","attr","setAttribute","getAttribute","removeAttr","removeAttribute","before","insertBefore","replacement","documentElement","nextId","ids","setNamespace","toXmlString","nextRelationshipId","addRelationship","rId","type","target","mode","Target","Type","Id","TargetMode","deleteRelationship","apply","getRelationshipsByRelationshipType","rtype","loadXml","strXml","override","part","addPart","addFile","data","cts","ContentType","PartName","deleteFile","fullPath","relPath","ctxPath","slashIndex","saveChanges","deleted","saveToBase64","generate","compression","saveToBlob","saveToDataURI","mimetype","getStyle","getComputedStyle","currentStyle","AQUA","BLACK","BLUE","FUCHSIA","GRAY","GREEN","LIME","MAROON","NAVY","OLIVE","PURPLE","RED","SILVER","TEAL","WHITE","YELLOW","addRun","style","text","run","currentBlock","runs","breakBlock","force","procNode","child","sblocker","cssStyle","display","isBlock","cstyle","tagName","listType","toLowerCase","link","href","hr","alt","src","children","slideMaster","slideLayout","slide","addSlide","slideNum","sldId","slideUri","template","relUri","r:id","id","contentSlide","content","shapes","spId","pptTable","pptContent","rels","relationshipId","slideLayoutObjects","folder","j","slo","slideLayoutId","fullUri","masterPath","layoutSections","sld","layoutName","ph","phType","hf","sldTemplate","index","fileName","sections","_block","txBody","level","_blocks","_inlineTable","_paragraph","_runs","parent","rPr","lastLink","val","paragraph","pPr","table","cind","cspan","rspan","row","cell","colspans","spanned","colspan","rowspan","_table","k","tbl","phTxbody","phTc","shape","ps","pptLine","graphicFrame","numbering","aFChunk","rStyleHyperlink","pStyleNoSpacing","pStyleListParagraph","pStyle","rStyle","_levelIndent","makeUl","makeList","fmt","fnt","makeOl","makeOlNum","makeOlHier","hier","levels","depth","numPart","nsid","random","anumid","listid","anum","lvl","lvlText","hLvlText","idt","heir","w:hanging","w:left","w:hint","w:hAnsi","w:ascii","num","docLine","seg","docContent","docChunk","uri","chunk","pPrs","define","amd","module","exports"],"mappings":"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","sourcesContent":["/*!\r\n * OpenXmlBuilder\r\n * The OpenXmlBuilder allows you to build simple OpenXml documents right in the browser.\r\n * Copyright (c) 2015 Jeremy Gore\r\n * Licensed MIT\r\n * https://github.com/jmgore75/openxmlbuilder\r\n * v0.1.1\r\n */\n(function(window, undefined) {\n  \"use strict\";\n  var OpenXmlBuilder = {};\n  OpenXmlBuilder.version = \"0.1.1\";\n  var ox = {};\n  ox.xmlns = \"http://www.w3.org/2000/xmlns/\";\n  ox.rel = \"http://schemas.openxmlformats.org/package/2006/relationships\";\n  ox.a = \"http://schemas.openxmlformats.org/drawingml/2006/main\";\n  ox.p = \"http://schemas.openxmlformats.org/presentationml/2006/main\";\n  ox.r = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships\";\n  ox.vt = \"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\";\n  ox.dcterms = \"http://purl.org/dc/terms/\";\n  ox.dc = \"http://purl.org/dc/elements/1.1/\";\n  ox.cp = \"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\";\n  ox.ep = \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\";\n  ox.w = \"http://schemas.openxmlformats.org/wordprocessingml/2006/main\";\n  ox.ct = \"http://schemas.openxmlformats.org/package/2006/content-types\";\n  var oxNs = {};\n  var selNs = \"\";\n  (function() {\n    for (var abbrev in ox) {\n      if (ox.hasOwnProperty(abbrev)) {\n        oxNs[ox[abbrev]] = abbrev;\n        if (abbrev === \"xmlns\") {\n          selNs += \" xmlns='\" + ox[abbrev] + \"'\";\n        } else {\n          selNs += \" xmlns:\" + abbrev + \"='\" + ox[abbrev] + \"'\";\n        }\n      }\n    }\n  })();\n  selNs = selNs.slice(1);\n  function nsResolver(pref) {\n    return ox[pref] || null;\n  }\n  function nameNS(name, rootNs) {\n    var r = {\n      full: name,\n      name: name,\n      ns: rootNs\n    };\n    r.pref = oxNs[rootNs] || \"\";\n    var toks = name.split(\":\");\n    if (toks.length === 2) {\n      r.pref = toks[0];\n      r.name = toks[1];\n      r.ns = ox[r.pref] || null;\n    }\n    r.use = r.ns === rootNs ? r.name : r.full;\n    return r;\n  }\n  var relTypes = {};\n  var relTypePrefix = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/\";\n  relTypes.hyperlink = relTypePrefix + \"hyperlink\";\n  var contTypes = {};\n  var xmlDoctype = '<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?>';\n  function docTemplate() {\n    var t = xmlDoctype;\n    t += \"<\" + arguments[0];\n    if (arguments.length > 1 && arguments[1]) {\n      t += \" xmlns='\" + ox[arguments[1]] + \"'\";\n    }\n    for (var i = 2; i < arguments.length; i++) {\n      t += \" xmlns:\" + arguments[i] + \"='\" + ox[arguments[i]] + \"'\";\n    }\n    t += \"></\" + arguments[0] + \">\";\n    return t;\n  }\n  var relsTemplate = docTemplate(\"Relationships\", \"rel\");\n  var EGHelper = {\n    makeDoc: function(xmlStr) {\n      return new DOMParser().parseFromString(xmlStr, \"text/xml\");\n    },\n    makeEl: function(doc, tag, rootNs) {\n      var r = nameNS(tag, rootNs);\n      return doc.createElementNS(r.ns || null, r.use);\n    },\n    toXml: function(doc) {\n      return new XMLSerializer().serializeToString(doc);\n    },\n    xpath: function(node, xpath, first) {\n      var doc = node.ownerDocument || node;\n      if (first) {\n        return doc.evaluate(xpath, node, nsResolver, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;\n      } else {\n        var rs = [];\n        var r = doc.evaluate(xpath, node, nsResolver, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n        for (var i = 0; i < r.snapshotLength; i++) {\n          rs.push(r.snapshotItem(i));\n        }\n        return rs;\n      }\n    },\n    setNs: function(node, ns, abbrev) {\n      node.setAttributeNS(ox.xmlns, abbrev ? \"xmlns:\" + abbrev : \"xmlns\", ns);\n    }\n  };\n  var IEHelper = {\n    makeDoc: function(xmlStr) {\n      var doc = new window.ActiveXObject(\"Microsoft.XMLDOM\");\n      doc.async = \"false\";\n      doc.loadXML(xmlStr);\n      doc.setProperty(\"SelectionNamespaces\", selNs);\n      return doc;\n    },\n    makeEl: function(doc, tag, rootNs) {\n      var r = nameNS(tag, rootNs);\n      return doc.createNode(1, r.use, r.ns || null);\n    },\n    toXml: function(doc) {\n      return doc.xml;\n    },\n    xpath: function(node, xpath, first) {\n      if (first) {\n        return node.selectSingleNode(xpath);\n      } else {\n        return node.selectNodes(xpath);\n      }\n    },\n    setNs: function(node, ns, abbrev) {\n      var a = node.doc.createNode(2, abbrev ? \"xmlns:\" + abbrev : \"xmlns\", ox.xmlns);\n      a.value = ns;\n      node.setAttributeNode(a);\n    }\n  };\n  var xhelp = window.DOMParser ? EGHelper : IEHelper;\n  OpenXmlBuilder.XMLHelper = xhelp;\n  function openXmlISOString(date) {\n    function pad2(number) {\n      if (number < 10) {\n        return \"0\" + number;\n      }\n      return number;\n    }\n    return date.getUTCFullYear() + \"-\" + pad2(date.getUTCMonth() + 1) + \"-\" + pad2(date.getUTCDate()) + \"T\" + pad2(date.getUTCHours()) + \":\" + pad2(date.getUTCMinutes()) + \":\" + pad2(date.getUTCSeconds()) + \"Z\";\n  }\n  function nodeWrap(nodes) {\n    var r = [];\n    for (var i = 0; i < nodes.length; i++) {\n      r.push(new XNode(nodes[i]));\n    }\n    return r;\n  }\n  function XNode(node) {\n    this.node = node;\n  }\n  XNode.prototype = {\n    all: function(path) {\n      return nodeWrap(xhelp.xpath(this.node, path, false));\n    },\n    one: function(path) {\n      var node = xhelp.xpath(this.node, path, true);\n      return node ? new XNode(node) : null;\n    },\n    remove: function() {\n      this.node.parentNode.removeChild(this.node);\n    },\n    setValue: function(value) {\n      if (this.node.nodeType === 1) {\n        while (this.node.firstChild) {\n          this.node.removeChild(this.node.firstChild);\n        }\n        var txt = this.node.ownerDocument.createTextNode(value);\n        this.node.appendChild(txt);\n      } else if (this.node.nodeType === 2) {\n        this.value = value;\n      }\n      return this;\n    },\n    getValue: function() {\n      if (this.node.nodeType === 2) {\n        return this.value;\n      } else {\n        return this.node.nodeValue;\n      }\n    },\n    setAttr: function(attr, value) {\n      this.node.setAttribute(attr, value);\n      return this;\n    },\n    getAttr: function(attr) {\n      return this.node.getAttribute(attr);\n    },\n    removeAttr: function(attr) {\n      this.node.removeAttribute(attr);\n      return this;\n    },\n    add: function(el, before) {\n      if (before) {\n        this.node.insertBefore(el.node, before.node);\n      } else {\n        this.node.appendChild(el.node);\n      }\n      return this;\n    },\n    replace: function(replacement) {\n      this.node.insertBefore(replacement.node);\n      this.remove();\n      return replacement;\n    }\n  };\n  function XDoc(xmlStr) {\n    if (xmlStr.charCodeAt(0) === 65279) {\n      xmlStr = xmlStr.substring(1);\n    }\n    this.doc = xhelp.makeDoc(xmlStr);\n    this.rootNs = this.root().getAttr(\"xmlns\");\n  }\n  XDoc.prototype = {\n    el: function(tag, attr, value) {\n      var el = new XNode(xhelp.makeEl(this.doc, tag, this.rootNs));\n      if (!value && attr && typeof attr !== \"object\") {\n        value = attr;\n        attr = null;\n      }\n      if (attr) {\n        for (var a in attr) {\n          if (attr.hasOwnProperty(a)) {\n            el.setAttr(a, attr[a]);\n          }\n        }\n      }\n      if (value) {\n        el.setValue(value);\n      }\n      return el;\n    },\n    root: function() {\n      return new XNode(this.doc.documentElement);\n    },\n    all: function(path) {\n      return nodeWrap(xhelp.xpath(this.doc, path, false));\n    },\n    one: function(path) {\n      var node = xhelp.xpath(this.doc, path, true);\n      return node ? new XNode(node) : null;\n    },\n    nextId: function(path, attr, first, pref) {\n      first = first || 0;\n      pref = pref || \"\";\n      var ids = {};\n      var es = this.all(path);\n      for (var i = 0; i < es.length; i++) {\n        ids[es[i].getAttr(attr)] = 1;\n      }\n      while (ids[pref + first]) {\n        first += 1;\n      }\n      return pref + first;\n    },\n    setNamespace: function(ns, abbrev) {\n      xhelp.setNs(this.root(), ns, abbrev);\n      if (!abbrev) {\n        this.rootNs = ns;\n      }\n    },\n    toXmlString: function() {\n      return xhelp.toXml(this.doc);\n    }\n  };\n  function XPart(xpkg, contentType, path, xmlStr, relsXmlStr) {\n    this.xpkg = xpkg;\n    this.path = path;\n    this.contentType = contentType;\n    var idx = path.lastIndexOf(\"/\") + 1;\n    this.relsPath = path.slice(0, idx) + \"_rels/\" + path.slice(idx) + \".rels\";\n    if (xmlStr) {\n      this.xdoc = new XDoc(xmlStr);\n      if (relsXmlStr) {\n        this.relsXdoc = new XDoc(relsXmlStr);\n      }\n    } else {\n      var f = this.xpkg.zip.file(this.path.slice(1));\n      if (f) {\n        this.xdoc = new XDoc(f.asText());\n        f = this.xpkg.zip.file(this.relsPath.slice(1));\n        if (f) {\n          this.relsXdoc = new XDoc(f.asText());\n        }\n      }\n    }\n  }\n  XPart.prototype = {\n    nextRelationshipId: function() {\n      if (!this.relsXdoc) {\n        return \"rId1\";\n      }\n      return this.relsXdoc.nextId(\"/rel:Relationships/rel:Relationship\", \"Id\", 1, \"rId\");\n    },\n    addRelationship: function(rId, type, target, mode) {\n      if (!this.relsXdoc) {\n        this.relsXdoc = new XDoc(relsTemplate);\n      }\n      var attr = {\n        Target: target,\n        Type: type,\n        Id: rId\n      };\n      mode = mode || \"External\";\n      if (mode !== \"Internal\") {\n        attr.TargetMode = mode;\n      }\n      var e = this.relsXdoc.el(\"rel:Relationship\", attr);\n      this.relsXdoc.root().add(e);\n    },\n    deleteRelationship: function(rId) {\n      if (this.relsXdoc) {\n        var es = this.relsXdoc.all(\"/rel:Relationships/rel:Relationship\");\n        for (var i = 0; i < es.length; i++) {\n          if (es[i].getAttr(\"Id\") === rId) {\n            es[i].remove();\n            if (es.length === 1) {\n              delete this.relsXdoc;\n            }\n            return;\n          }\n        }\n      }\n    },\n    el: function() {\n      return this.xdoc.el.apply(this.xdoc, arguments);\n    },\n    root: function() {\n      return this.xdoc.root();\n    },\n    all: function() {\n      return this.xdoc.all.apply(this.xdoc, arguments);\n    },\n    one: function() {\n      return this.xdoc.one.apply(this.xdoc, arguments);\n    },\n    nextId: function() {\n      return this.xdoc.nextId.apply(this.xdoc, arguments);\n    },\n    setNamespace: function() {\n      return this.xdoc.setNamespace.apply(this.xdoc, arguments);\n    },\n    getRelationshipsByRelationshipType: function(rtype) {\n      return this.relsXdoc.all(\"/rel:Relationships/rel:Relationship[@Type='\" + rtype + \"']\");\n    },\n    loadXml: function(strXml) {\n      this.xdoc = new XDoc(strXml);\n    }\n  };\n  function XPkg(b64Template, title, created, creator) {\n    this.zip = new JSZip(b64Template, {\n      base64: true,\n      checkCRC32: false\n    });\n    this.parts = {};\n    created = created || new Date();\n    created = openXmlISOString(created);\n    title = title || \"Document \" + created;\n    creator = creator || \"OpenXmlBuilder\";\n    this.ctDoc = new XDoc(this.zip.file(\"[Content_Types].xml\").asText());\n    var core = this.getPart(\"/docProps/core.xml\").xdoc;\n    core.one(\"//dcterms:created\").setValue(created);\n    core.one(\"//dcterms:modified\").setValue(created);\n    core.one(\"//cp:revision\").setValue(\"1\");\n    if (title) {\n      var titleElement = core.one(\"//dc:title\");\n      if (titleElement) {\n        titleElement.setValue(title);\n      } else {\n        core.root().add(core.el(\"dc:title\", title));\n      }\n    }\n    core.one(\"//dc:creator\").setValue(creator);\n    core.one(\"//cp:lastModifiedBy\").setValue(creator);\n  }\n  XPkg.prototype = {\n    getPart: function(path) {\n      if (this.parts.hasOwnProperty(path)) {\n        return this.parts[path];\n      } else {\n        var override = this.ctDoc.one(\"/ct:Types/ct:Override[@PartName='\" + path + \"']\");\n        var part = override ? new XPart(this, override.getAttr(\"ContentType\"), path) : null;\n        this.parts[path] = part;\n        return part;\n      }\n    },\n    addPart: function(contentType, path, xmlStr, relsXmlStr) {\n      var part = new XPart(this, contentType, path, xmlStr, relsXmlStr);\n      this.parts[path] = part;\n      return part;\n    },\n    addFile: function(ct, path, data) {\n      this.zip.file(path.slice(1), data);\n      var cts = this.ctDoc.all(\"/ct:Types/ct:Override\");\n      for (var i = 0; i < cts.length; i++) {\n        if (cts[i].getAttr(\"PartName\") === path) {\n          cts[i].remove();\n        }\n      }\n      var e = this.ctDoc.el(\"ct:Override\", {\n        ContentType: ct,\n        PartName: path\n      });\n      this.ctDoc.root().add(e);\n    },\n    deleteFile: function(path) {\n      this.zip.remove(path);\n      var cts = this.ctDoc.all(\"/ct:Types/ct:Override\");\n      for (var i = 0; i < cts.length; i++) {\n        if (cts[i].getAttr(\"PartName\") === path) {\n          cts[i].remove();\n        }\n      }\n    },\n    fullPath: function(relPath, ctxPath) {\n      if (relPath.indexOf(\"/\") === 0) {\n        return relPath;\n      }\n      ctxPath = ctxPath || \"/\";\n      var slashIndex = ctxPath.lastIndexOf(\"/\");\n      ctxPath = ctxPath.slice(0, slashIndex + 1);\n      while (relPath.indexOf(\"../\") === 0) {\n        ctxPath = ctxPath.slice(0, ctxPath.length - 1);\n        slashIndex = ctxPath.lastIndexOf(\"/\");\n        if (slashIndex === -1) {\n          throw \"internal error when processing relationships\";\n        }\n        ctxPath = ctxPath.slice(0, slashIndex + 1);\n        relPath = relPath.slice(3);\n      }\n      return ctxPath + relPath;\n    },\n    undoPart: function(path) {\n      delete this.parts[path];\n    },\n    saveChanges: function() {\n      var part;\n      for (var path in this.parts) {\n        if (this.parts.hasOwnProperty(path)) {\n          part = this.parts[path];\n          if (part.deleted || !part.xdoc) {\n            this.deleteFile(part.path);\n            this.zip.remove(part.relsPath);\n          } else {\n            this.addFile(part.contentType, part.path, part.xdoc.toXmlString());\n            if (part.relsXdoc) {\n              this.zip.file(part.relsPath.slice(1), part.relsXdoc.toXmlString());\n            } else {\n              this.zip.remove(part.relsPath);\n            }\n          }\n        }\n      }\n      this.parts = {};\n      this.zip.file(\"[Content_Types].xml\", this.ctDoc.toXmlString());\n      return this.zip;\n    },\n    saveToBase64: function() {\n      return this.saveChanges().generate({\n        compression: \"deflate\",\n        type: \"base64\"\n      });\n    },\n    saveToBlob: function() {\n      return this.saveChanges().generate({\n        compression: \"deflate\",\n        type: \"blob\"\n      });\n    },\n    saveToDataURI: function() {\n      return \"data:\" + this.mimetype + \";base64,\" + this.saveToBase64();\n    }\n  };\n  var getStyle = window.getComputedStyle || function(e) {\n    return e.currentStyle;\n  };\n  function leftPad(s, len, c) {\n    c = c || \" \";\n    len = len || 2;\n    while (s.length < len) {\n      s = c + s;\n    }\n    return s;\n  }\n  var colornames = {\n    AQUA: \"00FFFF\",\n    BLACK: \"000000\",\n    BLUE: \"0000FF\",\n    FUCHSIA: \"FF00FF\",\n    GRAY: \"808080\",\n    GREEN: \"008000\",\n    LIME: \"00FF00\",\n    MAROON: \"800000\",\n    NAVY: \"000080\",\n    OLIVE: \"808000\",\n    PURPLE: \"800080\",\n    RED: \"FF0000\",\n    SILVER: \"C0C0C0\",\n    TEAL: \"008080\",\n    WHITE: \"FFFFFF\",\n    YELLOW: \"FFFF00\"\n  };\n  function convertColor(c) {\n    var tem, i = 0;\n    c = c ? c.toString().toUpperCase() : \"\";\n    if (/^#[A-F0-9]{3,6}$/.test(c)) {\n      if (c.length < 7) {\n        var A = c.split(\"\");\n        c = A[1] + A[1] + A[2] + A[2] + A[3] + A[3];\n      } else {\n        c = c.substr(1, 8);\n      }\n      return c;\n    }\n    if (/^[A-Z]+$/.test(c)) {\n      return colornames[c] || \"\";\n    }\n    c = c.match(/\\d+(\\.\\d+)?%?/g) || [];\n    if (c.length < 3 || c.length > 4) {\n      return \"\";\n    }\n    for (i = 0; i < c.length; i++) {\n      tem = c[i];\n      if (tem.indexOf(\"%\") !== -1) {\n        tem = Math.round(parseFloat(tem) * 2.55);\n      } else {\n        tem = parseInt(tem, 10);\n      }\n      if (tem < 0 || tem > 255) {\n        return \"\";\n      } else {\n        c[i] = leftPad(tem.toString(16).toUpperCase(), 2, \"0\");\n      }\n    }\n    if (c.length === 4 && c[3] === \"00\") {\n      return \"\";\n    }\n    return c.slice(0, 3).join(\"\");\n  }\n  function convertStyle(s) {\n    var a = {};\n    if (s.verticalAlign === \"super\") {\n      a.sup = 1;\n    }\n    if (s.verticalAlign === \"sub\") {\n      a.sub = 1;\n    }\n    var i = parseInt(s.fontWeight, 10);\n    if (isNaN(i)) {\n      if (s.fontWeight === \"bold\") {\n        a.b = 1;\n      }\n    } else {\n      if (i >= 700) {\n        a.b = 1;\n      }\n    }\n    if (s.fontStyle === \"italic\") {\n      a.i = 1;\n    }\n    if (s.textDecoration === \"underline\") {\n      a.u = 1;\n    }\n    var color = convertColor(s.color);\n    if (color && color !== \"000000\") {\n      a.color = color;\n    }\n    color = convertColor(s.backgroundColor);\n    if (color && color !== \"FFFFFF\") {\n      a.bgColor = color;\n    }\n    return a;\n  }\n  function Blocker() {\n    this.blocks = [];\n    this.block = null;\n  }\n  Blocker.prototype = {\n    addRun: function(style, text) {\n      var run = {};\n      for (var attr in style) {\n        if (style.hasOwnProperty(attr)) {\n          run[attr] = style[attr];\n        }\n      }\n      run.text = text;\n      var block = this.currentBlock();\n      block.runs.push(run);\n      return run;\n    },\n    currentBlock: function() {\n      if (!this.block) {\n        this.block = {\n          type: \"paragraph\",\n          runs: []\n        };\n      }\n      return this.block;\n    },\n    breakBlock: function(force) {\n      if (this.block || force) {\n        var block = this.currentBlock();\n        this.blocks.push(block);\n        this.block = null;\n        return block;\n      } else if (this.blocks.length) {\n        return this.blocks[this.blocks.length - 1];\n      }\n    },\n    getBlocks: function() {\n      this.breakBlock();\n      return this.blocks;\n    },\n    procNode: function(style, child) {\n      var sblocker;\n      if (child.nodeType === 3) {\n        this.addRun(style, child.nodeValue);\n      } else if (child.nodeType === 1) {\n        var cssStyle = getStyle(child);\n        if (cssStyle.display === \"none\") {\n          return;\n        }\n        var isBlock = cssStyle.display === \"block\";\n        var cstyle = convertStyle(cssStyle);\n        if (isBlock) {\n          this.breakBlock();\n        }\n        if (child.tagName === \"LI\") {\n          this.breakBlock();\n          this.currentBlock().type = \"list-item\";\n          this.procNodes(cstyle, child.childNodes);\n        } else if (child.tagName === \"OL\" || child.tagName === \"UL\") {\n          this.breakBlock();\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"list\",\n            listType: child.tagName.toLowerCase(),\n            blocks: sblocker.getBlocks()\n          });\n        } else if (child.tagName === \"TABLE\") {\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"table\",\n            blocks: sblocker.blocks\n          });\n        } else if (child.tagName === \"TR\") {\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"table-row\",\n            blocks: sblocker.blocks\n          });\n        } else if (child.tagName === \"TD\" || child.tagName === \"TH\") {\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"table-cell\",\n            blocks: sblocker.getBlocks()\n          });\n        } else if (child.tagName === \"A\") {\n          cstyle.link = child.href;\n          this.procNodes(cstyle, child.childNodes);\n        } else if (child.tagName === \"HR\") {\n          this.currentBlock().hr = true;\n          this.breakBlock();\n        } else if (child.tagName === \"BR\") {\n          this.breakBlock();\n        } else if (child.tagName === \"IMG\") {\n          var run = this.addRun(cstyle, \"[\" + (child.alt || child.title || \"IMAGE\") + \"]\");\n          run.link = child.src;\n        } else {\n          this.procNodes(cstyle, child.childNodes);\n        }\n      }\n    },\n    procNodes: function(style, children) {\n      for (var i = 0; i < children.length; i++) {\n        this.procNode(style, children[i]);\n      }\n    }\n  };\n  function cleanupHtml(html) {\n    if (html) {\n      return html.replace(/[\\u200B-\\u200D\\uFEFF]/g, \"\");\n    }\n  }\n  function convertHtml(html) {\n    var d = document.createElement(\"DIV\");\n    var p = document.head || document.body;\n    p.appendChild(d);\n    d.innerHTML = cleanupHtml(html);\n    var mblocker = new Blocker();\n    mblocker.procNodes({}, d.childNodes);\n    p.removeChild(d);\n    d = null;\n    return mblocker.getBlocks();\n  }\n  OpenXmlBuilder.convertHtml = convertHtml;\n  relTypes.slideMaster = relTypePrefix + \"slideMaster\";\n  relTypes.slideLayout = relTypePrefix + \"slideLayout\";\n  relTypes.slide = relTypePrefix + \"slide\";\n  contTypes.slide = \"application/vnd.openxmlformats-officedocument.presentationml.slide+xml\";\n  function PPTXBuilder(b64Template, title, created, creator) {\n    XPkg.call(this, b64Template, title, created, creator);\n    this.presentation = this.getPart(\"/ppt/presentation.xml\");\n    this.sldIdLst = this.presentation.one(\"/p:presentation/p:sldIdLst\");\n    this.slideCount = this.sldIdLst.all(\"./p:sldId\").length;\n    this.app = this.getPart(\"/docProps/app.xml\").xdoc;\n    this.slidesProp = this.app.one(\"/ep:Properties/ep:Slides\");\n    this.slidesTitlesProp = this.app.all(\"/ep:Properties/ep:HeadingPairs/vt:vector/vt:variant/vt:i4\");\n    this.slidesTitlesProp = this.slidesTitlesProp[this.slidesTitlesProp.length - 1];\n    this.titlesVector = this.app.one(\"/ep:Properties/ep:TitlesOfParts/vt:vector\");\n    this.removeAllSlides();\n    this.slideLayouts = this._findLayouts();\n  }\n  PPTXBuilder.prototype = {\n    mimetype: \"application/vnd.openxmlformats-officedocument.presentationml.presentation\",\n    addSlide: function(title, slideLayout) {\n      slideLayout = slideLayout || this.slideLayouts[\"Title and Content\"];\n      this.slideCount++;\n      var slideNum = this.slideCount;\n      var sldId = slideNum + 255;\n      title = title || \"Slide \" + slideNum;\n      var slideUri = \"slides/slide\" + slideNum + \".xml\";\n      var slide = this.addPart(contTypes.slide, \"/ppt/\" + slideUri, slideLayout.template);\n      slide.addRelationship(slide.nextRelationshipId(), relTypes.slideLayout, slideLayout.relUri, \"Internal\");\n      var rId = this.presentation.nextRelationshipId();\n      this.presentation.addRelationship(rId, relTypes.slide, slideUri, \"Internal\");\n      this.sldIdLst.add(this.presentation.el(\"p:sldId\", {\n        \"r:id\": rId,\n        id: sldId\n      }));\n      this.slidesProp.setValue(slideNum);\n      this.slidesTitlesProp.setValue(slideNum);\n      this.titlesVector.add(this.app.el(\"vt:lpstr\", title));\n      this.titlesVector.setAttr(\"size\", slideNum + 1);\n      return slide;\n    },\n    contentSlide: function(content, slideLayout) {\n      var title = content.title || content[\"Title 1\"];\n      var slide = this.addSlide(title, slideLayout);\n      var shapes = slide.all(\"//p:sp\");\n      for (var i = 0; i < shapes.length; i++) {\n        var spId = shapes[i].one(\"./p:nvSpPr/p:cNvPr\").getAttr(\"name\");\n        var html = content[spId];\n        if (html) {\n          var blocks = convertHtml(html);\n          if (blocks.length === 1 && blocks[0].type === \"table\") {\n            this.pptTable(slide, shapes[i], blocks[0]);\n          } else {\n            this.pptContent(slide, shapes[i], blocks);\n          }\n        }\n      }\n    },\n    removeAllSlides: function() {\n      var rels = this.presentation.getRelationshipsByRelationshipType(relTypes.slide);\n      var rel, part;\n      for (var i = 0; i < rels.length; i++) {\n        rel = rels[i];\n        part = this.getPart(this.fullPath(rel.getAttr(\"Target\"), this.presentation.path));\n        this.presentation.deleteRelationship(rel.relationshipId);\n        part.deleted = true;\n      }\n      this.sldIdLst = this.presentation.one(\"/p:presentation/p:sldIdLst\");\n      var es = this.sldIdLst.all(\"./p:sldId\");\n      for (i = 0; i < es.length; i++) {\n        es[i].remove();\n      }\n      this.slidesProp.setValue(\"0\");\n      this.slidesTitlesProp.setValue(\"0\");\n      this.titlesVector.setAttr(\"size\", \"1\");\n      es = this.titlesVector.all(\"./vt:lpstr\");\n      for (i = 1; i < es.length; i++) {\n        es[i].remove();\n      }\n      this.slideCount = 0;\n    },\n    _findLayouts: function() {\n      var slideLayouts = {};\n      var slideLayoutObjects = this.zip.folder(\"/ppt/slideLayouts\").file(/^slideLayout\\d+\\.xml$/);\n      for (var j = 0; j < slideLayoutObjects.length; j++) {\n        var slo = slideLayoutObjects[j];\n        var slideLayoutId = parseInt(slo.name.slice(11, -4), 10);\n        var fullUri = \"/ppt/slideLayouts/\" + slo.name;\n        var relUri = \"../slideLayouts/\" + slo.name;\n        var slideLayout = new XDoc(slo.asText());\n        var masterPath = new XDoc(this.zip.file(\"/ppt/slideLayouts/_rels/\" + slo.name + \".rels\").asText()).one(\"/rel:Relationships/rel:Relationship[@Type='\" + relTypes.slideMaster + \"']\").getAttr(\"Target\");\n        var slideMaster = this.getPart(this.fullPath(masterPath, slideLayout.path));\n        var layoutSections = [];\n        var sld = slideLayout.root();\n        sld.removeAttr(\"preserve\");\n        sld.removeAttr(\"type\");\n        var layoutName = sld.one(\"p:cSld\").getAttr(\"name\");\n        sld.one(\"p:cSld\").removeAttr(\"name\");\n        var hf = slideMaster.one(\"//p:hf\");\n        var shapes = sld.all(\"//p:sp\");\n        var ph, phType;\n        for (var i = 0; i < shapes.length; i++) {\n          if (hf) {\n            ph = shapes[i].one(\"./p:nvSpPr/p:nvPr/p:ph\");\n            if (ph) {\n              phType = ph.getAttr(\"type\");\n              if (phType && hf.getAttr(phType) === \"0\") {\n                shapes[i].remove();\n                continue;\n              }\n            }\n          }\n          var spId = shapes[i].one(\"./p:nvSpPr/p:cNvPr\").getAttr(\"name\");\n          if (spId) {\n            layoutSections.push(spId);\n          }\n        }\n        var sldTemplate = slideLayout.toXmlString();\n        sldTemplate = sldTemplate.replace(/(<\\/?p:sld)Layout/g, \"$1\");\n        slideLayouts[layoutName] = {\n          name: layoutName,\n          index: slideLayoutId,\n          fileName: slo.name,\n          fullUri: fullUri,\n          relUri: relUri,\n          sections: layoutSections,\n          template: sldTemplate\n        };\n      }\n      return slideLayouts;\n    },\n    _block: function(slide, txBody, block, listType, level) {\n      if (block.type === \"list\") {\n        listType = block.listType || \"ul\";\n        level = level >= 0 ? level += 1 : 0;\n        this._blocks(slide, txBody, block.blocks, listType, level);\n      } else if (block.type === \"table\") {\n        this._inlineTable(slide, txBody, block);\n      } else if (block.type === \"list-item\") {\n        this._paragraph(slide, txBody, block, listType, level);\n      } else {\n        this._paragraph(slide, txBody, block, null, level);\n      }\n    },\n    _blocks: function(slide, txBody, blocks, listType, level) {\n      for (var i = 0; i < blocks.length; i++) {\n        this._block(slide, txBody, blocks[i], listType, level);\n      }\n    },\n    _runs: function(slide, parent, runs) {\n      var run, r, rPr, t, rId;\n      var lastLink;\n      for (var i = 0; i < runs.length; i++) {\n        run = runs[i];\n        r = slide.el(\"a:r\");\n        lastLink = run.link;\n        if (run.b || run.i || run.u || run.color || run.link) {\n          rPr = slide.el(\"a:rPr\");\n          if (run.b) {\n            rPr.setAttr(\"b\", \"1\");\n          }\n          if (run.i) {\n            rPr.setAttr(\"i\", \"1\");\n          }\n          if (run.u) {\n            rPr.setAttr(\"u\", \"sng\");\n          }\n          if (run.color) {\n            rPr.add(slide.el(\"a:solidFill\").add(slide.el(\"a:srgbClr\", {\n              val: run.color\n            })));\n          }\n          if (run.link) {\n            rId = slide.nextRelationshipId();\n            slide.addRelationship(rId, relTypes.hyperlink, run.link, \"External\");\n            rPr.add(slide.el(\"a:hlinkClick\", {\n              \"r:id\": rId\n            }));\n          }\n          r.add(rPr);\n        }\n        t = slide.el(\"a:t\", run.text);\n        r.add(t);\n        parent.add(r);\n      }\n      if (lastLink) {\n        parent.add(slide.el(\"a:endParaRPr\").add(slide.el(\"a:hlinkClick\", {\n          \"r:id\": \"\"\n        })));\n      }\n    },\n    _paragraph: function(slide, parent, paragraph, listType, level) {\n      var p, pPr;\n      p = slide.el(\"a:p\");\n      if (level >= 0 || listType !== \"ul\") {\n        pPr = slide.el(\"a:pPr\");\n        p.add(pPr);\n        if (level > 0) {\n          pPr.setAttr(\"lvl\", level);\n        }\n        if (listType === \"ol\") {\n          pPr.add(slide.el(\"a:buAutoNum\", {\n            type: \"arabicPeriod\"\n          }));\n        } else if (!listType) {\n          pPr.add(slide.el(\"a:buNone\"));\n        }\n        if (!listType && level >= 0) {\n          p.add(slide.el(\"a:r\").add(slide.el(\"a:t\", \"\t\")));\n        }\n      }\n      this._runs(slide, p, paragraph.runs);\n      parent.add(p);\n    },\n    _inlineTable: function(slide, parent, table, listType, level) {\n      var i, j, cind, cspan, rspan, row, cell;\n      var colspans = {};\n      var spanned = function() {\n        while (colspans[cind]) {\n          cspan = colspans[cind][1] || 1;\n          rspan = colspans[cind][0];\n          if (colspans[cind][0]) {\n            colspans[cind][0] -= 1;\n          } else {\n            delete colspans[cind];\n          }\n          cind += cspan;\n        }\n      };\n      this._paragraph(slide, parent, {\n        runs: [ {\n          u: true,\n          i: true,\n          text: \"Table\"\n        } ]\n      }, listType, level);\n      level = (level || 0) + 1;\n      for (i = 0; i < table.blocks.length; i++) {\n        row = table.blocks[i];\n        this._paragraph(slide, parent, {\n          runs: [ {\n            u: true,\n            i: true,\n            text: \"Row \" + (row + 1)\n          } ]\n        }, null, level);\n        cind = 0;\n        for (j = 0; j < row.blocks.length; j++) {\n          spanned();\n          cell = row.blocks[j];\n          cspan = cell.colspan || 1;\n          rspan = cell.rowspan;\n          this._paragraph(slide, parent, {\n            runs: [ {\n              i: true,\n              text: \"Column\" + (cind + 1)\n            } ]\n          }, null, level + 1);\n          this._blocks(slide, parent, cell, null, level + 1);\n          if (rspan > 1) {\n            colspans[cind] = [ rspan - 1, cspan || 1 ];\n          }\n          cind += cspan;\n        }\n        spanned();\n      }\n    },\n    _table: function(slide, parent, table) {\n      var i, j, k, row, cell, r, c, e, cspan, rspan, cind;\n      var tbl = slide.el(\"a:tbl\");\n      var phTxbody = function() {\n        return slide.el(\"a:txBody\").add(slide.el(\"a:bodyPr\")).add(slide.el(\"a:lstStyle\"));\n      };\n      var phTc = function() {\n        return slide.el(\"a:tc\").add(phTxbody().add(slide.el(\"a:p\"))).add(slide.el(\"a:tcPr\"));\n      };\n      var colspans = {};\n      var spanned = function() {\n        while (colspans[cind]) {\n          cspan = colspans[cind][1] || 1;\n          rspan = colspans[cind][0];\n          var c = phTc().setAttr(\"vMerge\", 1);\n          r.add(c);\n          if (cspan > 1) {\n            c.setAttr(\"gridSpan\", cspan);\n            for (k = 1; k < cspan; k++) {\n              r.add(phTc().setAttr(\"hMerge\", 1).setAttr(\"vMerge\", 1));\n            }\n          }\n          if (colspans[cind][0]) {\n            colspans[cind][0] -= 1;\n          } else {\n            delete colspans[cind];\n          }\n          cind += cspan;\n        }\n      };\n      for (i = 0; i < table.blocks.length; i++) {\n        row = table.blocks[i];\n        r = slide.el(\"a:tr\");\n        cind = 0;\n        for (j = 0; j < row.blocks.length; j++) {\n          spanned();\n          cell = row.blocks[j];\n          cspan = cell.colspan || 1;\n          rspan = cell.rowspan;\n          c = slide.el(\"a:tc\");\n          r.add(c);\n          if (cspan > 1) {\n            c.setAttr(\"gridSpan\", cspan);\n            for (k = 1; k < cspan; k++) {\n              r.add(phTc().setAttr(\"hMerge\", 1));\n            }\n          }\n          if (rspan > 1) {\n            colspans[cind] = [ rspan - 1, cspan || 1 ];\n          }\n          e = phTxbody();\n          c.add(e);\n          this._blocks(e, cell.blocks);\n          e = slide.el(\"a:tcPr\");\n          c.add(e);\n          cind += cspan;\n        }\n        spanned();\n        tbl.add(r);\n      }\n      parent.add(tbl);\n    },\n    pptContent: function(slide, shape, blocks) {\n      var txBody = shape.one(\"./p:txBody\");\n      var ps = txBody.all(\"./a:p\");\n      for (var j = 0; j < ps.length; j++) {\n        ps[j].remove();\n      }\n      this._blocks(slide, txBody, blocks);\n    },\n    pptLine: function(slide, shape, block) {\n      var txBody = shape.one(\"./p:txBody\");\n      var ps = txBody.all(\"./a:p\");\n      for (var j = 0; j < ps.length; j++) {\n        ps[j].remove();\n      }\n      if (block.type === \"paragraph\") {\n        this._paragraph(slide, txBody, block);\n      } else {\n        throw \"Block is not a paragraph\";\n      }\n    },\n    pptTable: function(slide, shape, block) {\n      var graphicFrame = slide.el(\"p:graphicFrame\");\n      var a, b, c, i;\n      a = slide.el(\"p:nvGraphicFramePr\");\n      graphicFrame.add(a);\n      b = shape.one(\"./p:cNvPr\");\n      if (b) {\n        a.add(b);\n      }\n      b = shape.one(\"./p:cNvSpPr\");\n      if (b) {\n        c = slide.el(\"p:cNvGraphicFramePr\");\n        b = b.all(\"./*\");\n        for (i = 0; i < b.length; i++) {\n          c.add(b[i]);\n        }\n        a.add(c);\n      }\n      b = shape.one(\"./p:nvPr\");\n      if (b) {\n        b.add(b);\n      }\n      a = slide.el(\"a:graphic\");\n      graphicFrame.add(a);\n      b = slide.el(\"a:graphicData\").setAttr(\"uri\", \"http://schemas.openxmlformats.org/drawingml/2006/table\");\n      a.add(b);\n      shape.replace(graphicFrame);\n      if (block.type === \"table\") {\n        this._table(slide, b, block);\n      } else {\n        throw \"Block is not a table\";\n      }\n    }\n  };\n  (function() {\n    for (var f in XPkg.prototype) {\n      if (XPkg.prototype.hasOwnProperty(f)) {\n        PPTXBuilder.prototype[f] = XPkg.prototype[f];\n      }\n    }\n  })();\n  OpenXmlBuilder.PPTXBuilder = PPTXBuilder;\n  relTypes.numbering = relTypePrefix + \"numbering\";\n  relTypes.aFChunk = relTypePrefix + \"aFChunk\";\n  contTypes.numbering = \"application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml\";\n  function _valBuild(e, v) {\n    return function(xdoc) {\n      return xdoc.el(e, {\n        \"w:val\": v\n      });\n    };\n  }\n  function DOCXBuilder(b64Template, title, created, creator) {\n    XPkg.call(this, b64Template, title, created, creator);\n    this.doc = this.getPart(\"/word/document.xml\");\n    this.body = this.doc.one(\"/w:document/w:body\");\n    this.sectPr = this.body.one(\"./w:sectPr\");\n    var es = this.body.all(\"./*\");\n    for (var i = 0; i < es.length; i++) {\n      es[i].remove();\n    }\n    if (this.sectPr) {\n      this.body.add(this.sectPr);\n    }\n    this.rStyles = {};\n    this.pStyles = {};\n    this.rStyles.Italic = this.rStyleItalic;\n    this.rStyles.Bold = this.rStyleBold;\n    this.rStyles.Underline = this.rStyleUnderline;\n    var styles = this.getPart(\"/word/document/styles.xml\").all(\"w:styles/w:style\");\n    for (i = 0; i < styles.length; i++) {\n      var styleType = styles[i].getAttr(\"w:type\");\n      var styleId = styles[i].getAttr(\"w:styleId\");\n      if (styleType === \"paragraph\") {\n        this.pStyles[styleId] = _valBuild(\"w:pStyle\", styleId);\n      } else if (styleType === \"character\") {\n        this.rStyles[styleId] = _valBuild(\"w:rStyle\", styleId);\n      }\n    }\n    this.undoPart(\"/word/document/styles.xml\");\n  }\n  DOCXBuilder.prototype = {\n    mimetype: \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n    rStyleItalic: function(xdoc) {\n      return xdoc.el(\"w:i\");\n    },\n    rStyleBold: function(xdoc) {\n      return xdoc.el(\"w:b\");\n    },\n    rStyleUnderline: _valBuild(\"w:u\", \"single\"),\n    rStyleHyperlink: _valBuild(\"w:rStyle\", \"Hyperlink\"),\n    pStyleNoSpacing: _valBuild(\"w:pStyle\", \"NoSpacing\"),\n    pStyleListParagraph: _valBuild(\"w:pStyle\", \"ListParagraph\"),\n    pStyle: function(name) {\n      return this.pStyles[name] || _valBuild(\"w:pStyle\", name);\n    },\n    rStyle: function(name) {\n      return this.rStyles[name] || _valBuild(\"w:rStyle\", name);\n    },\n    _levelIndent: function(level) {\n      return 720 * (1 + (level || 0));\n    },\n    makeUl: function() {\n      return this.makeList([ {\n        fmt: \"bullet\",\n        fnt: \"Symbol\",\n        txt: \"\"\n      }, {\n        fmt: \"bullet\",\n        fnt: \"Courier New\",\n        txt: \"o\"\n      }, {\n        fmt: \"bullet\",\n        fnt: \"Wingdings\",\n        txt: \"\"\n      } ], 9);\n    },\n    makeOl: function() {\n      return this.makeList([ {\n        fmt: \"decimal\"\n      }, {\n        fmt: \"lowerLetter\"\n      }, {\n        fmt: \"lowerRoman\"\n      } ], 9);\n    },\n    makeOlNum: function() {\n      return this.makeList([ {\n        fmt: \"decimal\"\n      } ], 9);\n    },\n    makeOlHier: function() {\n      return this.makeList([ {\n        fmt: \"decimal\",\n        hier: true\n      } ], 9);\n    },\n    makeList: function(levels, depth) {\n      var numPart = this.getPart(\"/word/numbering.xml\");\n      if (!numPart) {\n        numPart = this.addPart(contTypes.numbering, \"/word/numbering.xml\", docTemplate(\"w:numbering\", null, \"w\"));\n        this.doc.addRelationship(this.doc.nextRelationshipId(), relTypes.numbering, \"numbering.xml\", \"Internal\");\n      }\n      var nsid = Math.random().toString(16).substring(2, 10).toUpperCase();\n      var anumid = numPart.nextId(\"//w:abstractNum\", \"w:abstractNumId\", 0);\n      var listid = numPart.nextId(\"//w:num\", \"w:numId\", 1);\n      var anum = numPart.el(\"w:abstractNum\").setAttr(\"w:abstractNumId\", anumid);\n      anum.add(numPart.el(\"w:nsid\").setAttr(\"w:val\", nsid));\n      anum.add(numPart.el(\"w:multiLevelType\").setAttr(\"w:val\", \"hybridMultilevel\"));\n      var lvl, level, lvlText, hLvlText, idt;\n      depth = depth || levels.length;\n      for (var i = 0; i < depth; i++) {\n        level = levels[i % levels.length];\n        idt = this._levelIndent(i);\n        lvl = numPart.el(\"w:lvl\").setAttr(\"w:ilvl\", i);\n        lvl.add(numPart.el(\"w:start\").setAttr(\"w:val\", \"1\"));\n        lvl.add(numPart.el(\"w:numFmt\").setAttr(\"w:val\", level.fmt));\n        if (level.fmt === \"bullet\") {\n          lvlText = level.txt || \" \";\n          hLvlText = \"\";\n        } else {\n          lvlText = \"%\" + (i + 1) + \".\";\n          hLvlText += lvlText;\n        }\n        lvl.add(numPart.el(\"w:lvlText\").setAttr(\"w:val\", level.heir ? hLvlText : lvlText));\n        lvl.add(numPart.el(\"w:lvlJc\").setAttr(\"w:val\", \"left\"));\n        lvl.add(numPart.el(\"w:pPr\").add(numPart.el(\"w:ind\", {\n          \"w:hanging\": \"360\",\n          \"w:left\": idt\n        })));\n        if (level.fnt) {\n          lvl.add(numPart.el(\"w:rPr\").add(numPart.el(\"w:rFonts\", {\n            \"w:hint\": \"default\",\n            \"w:hAnsi\": level.fnt,\n            \"w:ascii\": level.fnt\n          })));\n        }\n        anum.add(lvl);\n      }\n      var num = numPart.el(\"w:num\").setAttr(\"w:numId\", listid);\n      num.add(numPart.el(\"w:abstractNumId\").setAttr(\"w:val\", anumid));\n      numPart.xdoc.root().add(anum);\n      numPart.xdoc.root().add(num);\n      return listid;\n    },\n    docLine: function(html, pStyle, rStyle) {\n      var seg = convertHtml(html);\n      if (seg.length === 1 && seg[0].type === \"paragraph\") {\n        seg = seg[0];\n        this._paragraph(this.body, this.sectPr, seg, pStyle, rStyle);\n      } else {\n        throw \"Content is too complex\";\n      }\n    },\n    docContent: function(html) {\n      var blocks = convertHtml(html);\n      this._blocks(this.body, this.sectPr, blocks);\n    },\n    docChunk: function(html) {\n      html = \"<html><head></head><body>\" + cleanupHtml(html) + \"</body></html>\";\n      var rId = this.doc.nextRelationshipId();\n      var uri = \"/word/chunk\" + rId + \".html\";\n      this.addFile(\"text/html\", uri, html);\n      this.doc.addRelationship(rId, relTypes.aFChunk, uri, \"Internal\");\n      var chunk = this.doc.el(\"w:altChunk\").setAttr(\"r:id\", rId);\n      this.body.add(chunk, this.sectPr);\n    },\n    _block: function(parent, before, block, listid, level) {\n      var pPrs;\n      if (block.type === \"table\") {\n        this._table(parent, before, block);\n      } else if (block.type === \"list\") {\n        if (!listid) {\n          listid = block.listType === \"ul\" ? this.makeUl() : this.makeOlHier();\n          level = 0;\n        } else {\n          level += 1;\n        }\n        this._blocks(parent, before, block.blocks, listid, level);\n      } else if (block.type === \"list-item\" && listid) {\n        pPrs = this.doc.el(\"w:numPr\");\n        pPrs.add(_valBuild(\"w:ilvl\", level)(this.doc.xdoc));\n        pPrs.add(_valBuild(\"w:numId\", listid)(this.doc.xdoc));\n        this._paragraph(parent, before, block, null, null, pPrs);\n      } else if (listid) {\n        pPrs = this.doc.el(\"w:ind\").setAttr(\"w:left\", this._levelIndent(level));\n        this._paragraph(parent, before, block, this.pStyleListParagraph, null, pPrs);\n      } else {\n        this._paragraph(parent, before, block);\n      }\n    },\n    _blocks: function(parent, before, blocks, listid, level) {\n      for (var i = 0; i < blocks.length; i++) {\n        this._block(parent, before, blocks[i], listid, level);\n      }\n    },\n    _runs: function(parent, runs, rStyle) {\n      var run, r, rPr, t;\n      for (var i = 0; i < runs.length; i++) {\n        run = runs[i];\n        r = this.doc.el(\"w:r\");\n        if (run.b || run.i || run.u || run.color || run.link || rStyle) {\n          rPr = this.doc.el(\"w:rPr\");\n          if (run.link) {\n            if (rStyle) {\n              rPr.add(this.rStyleUnderline(this.doc.xdoc));\n            } else {\n              rPr.add(this.rStyleHyperlink(this.doc.xdoc));\n            }\n          }\n          if (rStyle) {\n            rPr.add(rStyle(this.doc.xdoc));\n          }\n          if (run.b) {\n            rPr.add(this.rStyleBold(this.doc.xdoc));\n          }\n          if (run.i) {\n            rPr.add(this.rStyleItalic(this.doc.xdoc));\n          }\n          if (run.u) {\n            rPr.add(this.rStyleUnderline(this.doc.xdoc));\n          }\n          if (run.color) {\n            rPr.add(_valBuild(\"w:color\", run.color)(this.doc.xdoc));\n          }\n          r.add(rPr);\n        }\n        t = this.doc.el(\"w:t\", run.text);\n        if (/^\\s+|\\s+$/.test(run.text)) {\n          t.setAttr(\"xml:space\", \"preserve\");\n        }\n        r.add(t);\n        if (run.link) {\n          var rId = this.doc.nextRelationshipId();\n          this.doc.addRelationship(rId, relTypes.hyperlink, run.link, \"External\");\n          r = this.doc.el(\"w:hyperlink\").setAttr(\"r:id\", rId).add(r);\n        }\n        parent.add(r);\n      }\n    },\n    _paragraph: function(parent, before, paragraph, pStyle, rStyle, pPrs) {\n      var p, pPr;\n      p = this.doc.el(\"w:p\");\n      if (pStyle || rStyle || pPrs) {\n        pPr = this.doc.el(\"w:pPr\");\n        if (pStyle) {\n          pPr.add(pStyle(this.doc.xdoc));\n        }\n        if (rStyle) {\n          pPr.add(this.doc.el(\"w:rPr\").add(rStyle(this.doc.xdoc)));\n        }\n        if (paragraph.hr) {\n          var hr = this.doc.el(\"w:pBdr\");\n          hr.add(this.doc.el(\"w:bottom\").setAttr(\"w:color\", \"auto\").setAttr(\"w:space\", \"1\").setAttr(\"w:sz\", \"6\").setAttr(\"w:val\", \"single\"));\n          pPr.add(hr);\n        }\n        if (pPrs) {\n          pPr.add(pPrs);\n        }\n        p.add(pPr);\n      }\n      this._runs(p, paragraph.runs, rStyle);\n      parent.add(p, before);\n    },\n    _table: function(parent, before, table) {\n      var i, j, row, cell, r, c, e, cspan, rspan, cind;\n      var tbl = this.doc.el(\"w:tbl\");\n      var colspans = {};\n      var spanned = function() {\n        while (colspans[cind]) {\n          cspan = colspans[cind][1] || 1;\n          rspan = colspans[cind][0];\n          c = this.doc.el(\"w:tc\");\n          e = this.doc.el(\"w:tcPr\");\n          if (cspan > 1) {\n            e.add(this.doc.el(\"w:gridSpan\").setAttr(\"w:val\", cspan));\n          }\n          e.add(this.doc.el(\"w:vMerge\"));\n          c.add(e);\n          c.add(this.doc.el(\"w:p\"));\n          if (colspans[cind][0]) {\n            colspans[cind][0] -= 1;\n          } else {\n            delete colspans[cind];\n          }\n          r.add(c);\n          cind += cspan;\n        }\n      };\n      for (i = 0; i < table.blocks.length; i++) {\n        row = table.blocks[i];\n        r = this.doc.el(\"w:tr\");\n        cind = 0;\n        for (j = 0; j < row.blocks.length; j++) {\n          spanned();\n          c = this.doc.el(\"w:tc\");\n          cspan = cell.colspan || 1;\n          rspan = cell.rowspan;\n          cell = row.blocks[j];\n          e = this.doc.el(\"w:tcPr\");\n          if (cspan > 1) {\n            e.add(this.doc.el(\"w:gridSpan\").setAttr(\"w:val\", cspan));\n          }\n          if (rspan > 1) {\n            colspans[cind] = [ rspan - 1, cspan || 1 ];\n            e.add(this.doc.el(\"w:vMerge\").setAttr(\"w:val\", \"restart\"));\n          }\n          c.add(e);\n          this._blocks(c, cell.blocks);\n          r.add(c);\n          cind += cspan;\n        }\n        spanned();\n        tbl.add(r);\n      }\n      parent.add(tbl, before);\n    }\n  };\n  (function() {\n    for (var f in XPkg.prototype) {\n      if (XPkg.prototype.hasOwnProperty(f)) {\n        DOCXBuilder.prototype[f] = XPkg.prototype[f];\n      }\n    }\n  })();\n  OpenXmlBuilder.DOCXBuilder = DOCXBuilder;\n  if (typeof define === \"function\" && define.amd) {\n    define(function() {\n      return OpenXmlBuilder;\n    });\n  } else if (typeof module === \"object\" && module && typeof module.exports === \"object\" && module.exports) {\n    module.exports = OpenXmlBuilder;\n  } else {\n    window.OpenXmlBuilder = OpenXmlBuilder;\n  }\n})(function() {\n  return this;\n}());"]}