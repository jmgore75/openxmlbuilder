{"version":3,"file":"OpenXmlBuilder.min.js","sources":["OpenXmlBuilder.js"],"names":["window","undefined","nsResolver","pref","ox","nameNS","name","rootNs","r","full","ns","oxNs","toks","split","length","use","docTemplate","t","xmlDoctype","arguments","i","openXmlISOString","date","pad2","number","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","nodeWrap","nodes","push","XNode","node","this","XDoc","xmlStr","charCodeAt","substring","doc","xhelp","makeDoc","root","getAttr","XPart","xpkg","contentType","path","relsXmlStr","idx","lastIndexOf","relsPath","slice","xdoc","relsXdoc","f","zip","file","asText","XPkg","b64Template","title","created","creator","JSZip","base64","checkCRC32","parts","Date","ctDoc","core","getPart","one","setValue","titleElement","add","el","leftPad","s","len","c","convertColor","tem","toString","toUpperCase","test","A","substr","colornames","match","indexOf","Math","round","parseFloat","parseInt","join","convertStyle","a","verticalAlign","sup","sub","fontWeight","isNaN","b","fontStyle","textDecoration","u","color","backgroundColor","bgColor","Blocker","blocks","block","convertHtml","html","d","document","createElement","p","head","body","appendChild","innerHTML","mblocker","procNodes","childNodes","removeChild","getBlocks","PPTXBuilder","call","slideCount","presentation","sldIdLst","es","all","remove","app","slidesProp","slidesTitlesProp","titlesVector","setAttr","rel","part","rels","getRelationshipsByRelationshipType","relTypes","slide","fullPath","deleteRelationship","relationshipId","deleted","_valBuild","e","v","w:val","DOCXBuilder","sectPr","OpenXmlBuilder","version","xmlns","vt","dcterms","dc","cp","ep","w","ct","selNs","abbrev","hasOwnProperty","relTypePrefix","hyperlink","contTypes","relsTemplate","EGHelper","DOMParser","parseFromString","makeEl","tag","createElementNS","toXml","XMLSerializer","serializeToString","xpath","first","ownerDocument","evaluate","XPathResult","FIRST_ORDERED_NODE_TYPE","singleNodeValue","rs","ORDERED_NODE_SNAPSHOT_TYPE","snapshotLength","snapshotItem","setNs","setAttributeNS","IEHelper","ActiveXObject","async","loadXML","setProperty","createNode","xml","selectSingleNode","selectNodes","value","setAttributeNode","XMLHelper","prototype","parentNode","nodeType","firstChild","txt","createTextNode","getValue","nodeValue","attr","setAttribute","getAttribute","removeAttr","removeAttribute","before","insertBefore","replace","replacement","documentElement","nextId","ids","setNamespace","toXmlString","nextRelationshipId","addRelationship","rId","type","target","mode","Target","Type","Id","TargetMode","apply","rtype","loadXml","strXml","override","addPart","addFile","data","cts","ContentType","PartName","deleteFile","relPath","ctxPath","slashIndex","undoPart","saveChanges","saveToBase64","generate","compression","saveToBlob","saveToDataURI","mimetype","getStyle","getComputedStyle","currentStyle","AQUA","BLACK","BLUE","FUCHSIA","GRAY","GREEN","LIME","MAROON","NAVY","OLIVE","PURPLE","RED","SILVER","TEAL","WHITE","YELLOW","addRun","style","text","run","currentBlock","runs","breakBlock","force","procNode","child","sblocker","cssStyle","display","isBlock","cstyle","tagName","listType","toLowerCase","link","href","hr","alt","src","children","slideMaster","slideLayout","addSlide","slideLayoutId","slideNum","sldId","slideUri","slideLayoutUri","sldTemplate","sld","hf","ph","phType","shapes","r:id","id","contentSlide","content","spId","pptContent","_block","txBody","level","_blocks","_inlineTable","_paragraph","_runs","parent","rPr","lastLink","val","paragraph","pPr","table","j","cind","cspan","rspan","row","cell","colspans","spanned","colspan","rowspan","_table","k","tbl","phTxbody","phTc","shape","ps","pptLine","pptTable","graphicFrame","numbering","aFChunk","rStyleItalic","rStyleBold","rStyleUnderline","rStyleHyperlink","pStyleNoSpacing","pStyleListParagraph","pStyle","rStyle","_levelIndent","makeUl","makeList","fmt","fnt","makeOl","makeOlNum","makeOlHier","hier","levels","depth","numPart","nsid","random","anumid","listid","anum","lvl","lvlText","hLvlText","idt","heir","w:hanging","w:left","w:hint","w:hAnsi","w:ascii","num","docLine","seg","docContent","docChunk","uri","chunk","pPrs","define","amd","module","exports"],"mappings":"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","sourcesContent":["/*!\r\n * OpenXmlBuilder\r\n * The OpenXmlBuilder allows you to build simple OpenXml documents right in the browser.\r\n * Copyright (c) 2015 Jeremy Gore\r\n * Licensed MIT\r\n * https://github.com/jmgore75/openxmlbuilder\r\n * v0.1.0\r\n */\n(function(window, undefined) {\n  \"use strict\";\n  var OpenXmlBuilder = {};\n  OpenXmlBuilder.version = \"0.1.0\";\n  var ox = {};\n  ox.xmlns = \"http://www.w3.org/2000/xmlns/\";\n  ox.rel = \"http://schemas.openxmlformats.org/package/2006/relationships\";\n  ox.a = \"http://schemas.openxmlformats.org/drawingml/2006/main\";\n  ox.p = \"http://schemas.openxmlformats.org/presentationml/2006/main\";\n  ox.r = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships\";\n  ox.vt = \"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\";\n  ox.dcterms = \"http://purl.org/dc/terms/\";\n  ox.dc = \"http://purl.org/dc/elements/1.1/\";\n  ox.cp = \"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\";\n  ox.ep = \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\";\n  ox.w = \"http://schemas.openxmlformats.org/wordprocessingml/2006/main\";\n  ox.ct = \"http://schemas.openxmlformats.org/package/2006/content-types\";\n  var oxNs = {};\n  var selNs = \"\";\n  (function() {\n    for (var abbrev in ox) {\n      if (ox.hasOwnProperty(abbrev)) {\n        oxNs[ox[abbrev]] = abbrev;\n        if (abbrev === \"xmlns\") {\n          selNs += \" xmlns='\" + ox[abbrev] + \"'\";\n        } else {\n          selNs += \" xmlns:\" + abbrev + \"='\" + ox[abbrev] + \"'\";\n        }\n      }\n    }\n  })();\n  selNs = selNs.slice(1);\n  function nsResolver(pref) {\n    return ox[pref] || null;\n  }\n  function nameNS(name, rootNs) {\n    var r = {\n      full: name,\n      name: name,\n      ns: rootNs\n    };\n    r.pref = oxNs[rootNs] || \"\";\n    var toks = name.split(\":\");\n    if (toks.length === 2) {\n      r.pref = toks[0];\n      r.name = toks[1];\n      r.ns = ox[r.pref] || null;\n    }\n    r.use = r.ns === rootNs ? r.name : r.full;\n    return r;\n  }\n  var relTypes = {};\n  var relTypePrefix = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/\";\n  relTypes.hyperlink = relTypePrefix + \"hyperlink\";\n  var contTypes = {};\n  var xmlDoctype = '<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?>';\n  function docTemplate() {\n    var t = xmlDoctype;\n    t += \"<\" + arguments[0];\n    if (arguments.length > 1 && arguments[1]) {\n      t += \" xmlns='\" + ox[arguments[1]] + \"'\";\n    }\n    for (var i = 2; i < arguments.length; i++) {\n      t += \" xmlns:\" + arguments[i] + \"='\" + ox[arguments[i]] + \"'\";\n    }\n    t += \"></\" + arguments[0] + \">\";\n    return t;\n  }\n  var relsTemplate = docTemplate(\"Relationships\", \"rel\");\n  var EGHelper = {\n    makeDoc: function(xmlStr) {\n      return new DOMParser().parseFromString(xmlStr, \"text/xml\");\n    },\n    makeEl: function(doc, tag, rootNs) {\n      var r = nameNS(tag, rootNs);\n      return doc.createElementNS(r.ns || null, r.use);\n    },\n    toXml: function(doc) {\n      return new XMLSerializer().serializeToString(doc);\n    },\n    xpath: function(node, xpath, first) {\n      var doc = node.ownerDocument || node;\n      if (first) {\n        return doc.evaluate(xpath, node, nsResolver, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;\n      } else {\n        var rs = [];\n        var r = doc.evaluate(xpath, node, nsResolver, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n        for (var i = 0; i < r.snapshotLength; i++) {\n          rs.push(r.snapshotItem(i));\n        }\n        return rs;\n      }\n    },\n    setNs: function(node, ns, abbrev) {\n      node.setAttributeNS(ox.xmlns, abbrev ? \"xmlns:\" + abbrev : \"xmlns\", ns);\n    }\n  };\n  var IEHelper = {\n    makeDoc: function(xmlStr) {\n      var doc = new window.ActiveXObject(\"Microsoft.XMLDOM\");\n      doc.async = \"false\";\n      doc.loadXML(xmlStr);\n      doc.setProperty(\"SelectionNamespaces\", selNs);\n      return doc;\n    },\n    makeEl: function(doc, tag, rootNs) {\n      var r = nameNS(tag, rootNs);\n      return doc.createNode(1, r.use, r.ns || null);\n    },\n    toXml: function(doc) {\n      return doc.xml;\n    },\n    xpath: function(node, xpath, first) {\n      if (first) {\n        return node.selectSingleNode(xpath);\n      } else {\n        return node.selectNodes(xpath);\n      }\n    },\n    setNs: function(node, ns, abbrev) {\n      var a = node.doc.createNode(2, abbrev ? \"xmlns:\" + abbrev : \"xmlns\", ox.xmlns);\n      a.value = ns;\n      node.setAttributeNode(a);\n    }\n  };\n  var xhelp = window.DOMParser ? EGHelper : IEHelper;\n  OpenXmlBuilder.XMLHelper = xhelp;\n  function openXmlISOString(date) {\n    function pad2(number) {\n      if (number < 10) {\n        return \"0\" + number;\n      }\n      return number;\n    }\n    return date.getUTCFullYear() + \"-\" + pad2(date.getUTCMonth() + 1) + \"-\" + pad2(date.getUTCDate()) + \"T\" + pad2(date.getUTCHours()) + \":\" + pad2(date.getUTCMinutes()) + \":\" + pad2(date.getUTCSeconds()) + \"Z\";\n  }\n  function nodeWrap(nodes) {\n    var r = [];\n    for (var i = 0; i < nodes.length; i++) {\n      r.push(new XNode(nodes[i]));\n    }\n    return r;\n  }\n  function XNode(node) {\n    this.node = node;\n  }\n  XNode.prototype = {\n    all: function(path) {\n      return nodeWrap(xhelp.xpath(this.node, path, false));\n    },\n    one: function(path) {\n      var node = xhelp.xpath(this.node, path, true);\n      return node ? new XNode(node) : null;\n    },\n    remove: function() {\n      this.node.parentNode.removeChild(this.node);\n    },\n    setValue: function(value) {\n      if (this.node.nodeType === 1) {\n        while (this.node.firstChild) {\n          this.node.removeChild(this.node.firstChild);\n        }\n        var txt = this.node.ownerDocument.createTextNode(value);\n        this.node.appendChild(txt);\n      } else if (this.node.nodeType === 2) {\n        this.value = value;\n      }\n      return this;\n    },\n    getValue: function() {\n      if (this.node.nodeType === 2) {\n        return this.value;\n      } else {\n        return this.node.nodeValue;\n      }\n    },\n    setAttr: function(attr, value) {\n      this.node.setAttribute(attr, value);\n      return this;\n    },\n    getAttr: function(attr) {\n      return this.node.getAttribute(attr);\n    },\n    removeAttr: function(attr) {\n      this.node.removeAttribute(attr);\n      return this;\n    },\n    add: function(el, before) {\n      if (before) {\n        this.node.insertBefore(el.node, before.node);\n      } else {\n        this.node.appendChild(el.node);\n      }\n      return this;\n    },\n    replace: function(replacement) {\n      this.node.insertBefore(replacement.node);\n      this.remove();\n      return replacement;\n    }\n  };\n  function XDoc(xmlStr) {\n    if (xmlStr.charCodeAt(0) === 65279) {\n      xmlStr = xmlStr.substring(1);\n    }\n    this.doc = xhelp.makeDoc(xmlStr);\n    this.rootNs = this.root().getAttr(\"xmlns\");\n  }\n  XDoc.prototype = {\n    el: function(tag, attr, value) {\n      var el = new XNode(xhelp.makeEl(this.doc, tag, this.rootNs));\n      if (!value && attr && typeof attr !== \"object\") {\n        value = attr;\n        attr = null;\n      }\n      if (attr) {\n        for (var a in attr) {\n          if (attr.hasOwnProperty(a)) {\n            el.setAttr(a, attr[a]);\n          }\n        }\n      }\n      if (value) {\n        el.setValue(value);\n      }\n      return el;\n    },\n    root: function() {\n      return new XNode(this.doc.documentElement);\n    },\n    all: function(path) {\n      return nodeWrap(xhelp.xpath(this.doc, path, false));\n    },\n    one: function(path) {\n      var node = xhelp.xpath(this.doc, path, true);\n      return node ? new XNode(node) : null;\n    },\n    nextId: function(path, attr, first, pref) {\n      first = first || 0;\n      pref = pref || \"\";\n      var ids = {};\n      var es = this.all(path);\n      for (var i = 0; i < es.length; i++) {\n        ids[es[i].getAttr(attr)] = 1;\n      }\n      while (ids[pref + first]) {\n        first += 1;\n      }\n      return pref + first;\n    },\n    setNamespace: function(ns, abbrev) {\n      xhelp.setNs(this.root(), ns, abbrev);\n      if (!abbrev) {\n        this.rootNs = ns;\n      }\n    },\n    toXmlString: function() {\n      return xhelp.toXml(this.doc);\n    }\n  };\n  function XPart(xpkg, contentType, path, xmlStr, relsXmlStr) {\n    this.xpkg = xpkg;\n    this.path = path;\n    this.contentType = contentType;\n    var idx = path.lastIndexOf(\"/\") + 1;\n    this.relsPath = path.slice(0, idx) + \"_rels/\" + path.slice(idx) + \".rels\";\n    if (xmlStr) {\n      this.xdoc = new XDoc(xmlStr);\n      if (relsXmlStr) {\n        this.relsXdoc = new XDoc(relsXmlStr);\n      }\n    } else {\n      var f = this.xpkg.zip.file(this.path.slice(1));\n      if (f) {\n        this.xdoc = new XDoc(f.asText());\n        f = this.xpkg.zip.file(this.relsPath.slice(1));\n        if (f) {\n          this.relsXdoc = new XDoc(f.asText());\n        }\n      }\n    }\n  }\n  XPart.prototype = {\n    nextRelationshipId: function() {\n      if (!this.relsXdoc) {\n        return \"rId1\";\n      }\n      return this.relsXdoc.nextId(\"/rel:Relationships/rel:Relationship\", \"Id\", 1, \"rId\");\n    },\n    addRelationship: function(rId, type, target, mode) {\n      if (!this.relsXdoc) {\n        this.relsXdoc = new XDoc(relsTemplate);\n      }\n      var attr = {\n        Target: target,\n        Type: type,\n        Id: rId\n      };\n      mode = mode || \"External\";\n      if (mode !== \"Internal\") {\n        attr.TargetMode = mode;\n      }\n      var e = this.relsXdoc.el(\"rel:Relationship\", attr);\n      this.relsXdoc.root().add(e);\n    },\n    deleteRelationship: function(rId) {\n      if (this.relsXdoc) {\n        var es = this.relsXdoc.all(\"/rel:Relationships/rel:Relationship\");\n        for (var i = 0; i < es.length; i++) {\n          if (es[i].getAttr(\"Id\") === rId) {\n            es[i].remove();\n            if (es.length === 1) {\n              delete this.relsXdoc;\n            }\n            return;\n          }\n        }\n      }\n    },\n    el: function() {\n      return this.xdoc.el.apply(this.xdoc, arguments);\n    },\n    root: function() {\n      return this.xdoc.root();\n    },\n    all: function() {\n      return this.xdoc.all.apply(this.xdoc, arguments);\n    },\n    one: function() {\n      return this.xdoc.one.apply(this.xdoc, arguments);\n    },\n    nextId: function() {\n      return this.xdoc.nextId.apply(this.xdoc, arguments);\n    },\n    setNamespace: function() {\n      return this.xdoc.setNamespace.apply(this.xdoc, arguments);\n    },\n    getRelationshipsByRelationshipType: function(rtype) {\n      return this.relsXdoc.all(\"/rel:Relationships/rel:Relationship[@Type='\" + rtype + \"']\");\n    },\n    loadXml: function(strXml) {\n      this.xdoc = new XDoc(strXml);\n    }\n  };\n  function XPkg(b64Template, title, created, creator) {\n    this.zip = new JSZip(b64Template, {\n      base64: true,\n      checkCRC32: false\n    });\n    this.parts = {};\n    created = created || new Date();\n    title = title || \"Document \" + openXmlISOString(created);\n    creator = creator || \"OpenXmlBuilder\";\n    this.ctDoc = new XDoc(this.zip.file(\"[Content_Types].xml\").asText());\n    var core = this.getPart(\"/docProps/core.xml\").xdoc;\n    core.one(\"//dcterms:created\").setValue(openXmlISOString(created));\n    core.one(\"//dcterms:modified\").setValue(openXmlISOString(created));\n    if (title) {\n      var titleElement = core.one(\"//dc:title\");\n      if (titleElement) {\n        titleElement.setValue(title);\n      } else {\n        core.root().add(core.el(\"dc:title\", title));\n      }\n    }\n    if (creator) {\n      core.one(\"//dc:creator\").setValue(creator);\n      core.one(\"//cp:lastModifiedBy\").setValue(creator);\n    }\n  }\n  XPkg.prototype = {\n    getPart: function(path) {\n      if (this.parts.hasOwnProperty(path)) {\n        return this.parts[path];\n      } else {\n        var override = this.ctDoc.one(\"/ct:Types/ct:Override[@PartName='\" + path + \"']\");\n        var part = override ? new XPart(this, override.getAttr(\"ContentType\"), path) : null;\n        this.parts[path] = part;\n        return part;\n      }\n    },\n    addPart: function(contentType, path, xmlStr, relsXmlStr) {\n      var part = new XPart(this, contentType, path, xmlStr, relsXmlStr);\n      this.parts[path] = part;\n      return part;\n    },\n    addFile: function(ct, path, data) {\n      this.zip.file(path.slice(1), data);\n      var cts = this.ctDoc.all(\"/ct:Types/ct:Override\");\n      for (var i = 0; i < cts.length; i++) {\n        if (cts[i].getAttr(\"PartName\") === path) {\n          cts[i].remove();\n        }\n      }\n      var e = this.ctDoc.el(\"ct:Override\", {\n        ContentType: ct,\n        PartName: path\n      });\n      this.ctDoc.root().add(e);\n    },\n    deleteFile: function(path) {\n      this.zip.remove(path);\n      var cts = this.ctDoc.all(\"/ct:Types/ct:Override\");\n      for (var i = 0; i < cts.length; i++) {\n        if (cts[i].getAttr(\"PartName\") === path) {\n          cts[i].remove();\n        }\n      }\n    },\n    fullPath: function(relPath, ctxPath) {\n      if (relPath.indexOf(\"/\") === 0) {\n        return relPath;\n      }\n      ctxPath = ctxPath || \"/\";\n      var slashIndex = ctxPath.lastIndexOf(\"/\");\n      ctxPath = ctxPath.slice(0, slashIndex + 1);\n      while (relPath.indexOf(\"../\") === 0) {\n        ctxPath = ctxPath.slice(0, ctxPath.length - 1);\n        slashIndex = ctxPath.lastIndexOf(\"/\");\n        if (slashIndex === -1) {\n          throw \"internal error when processing relationships\";\n        }\n        ctxPath = ctxPath.slice(0, slashIndex + 1);\n        relPath = relPath.slice(3);\n      }\n      return ctxPath + relPath;\n    },\n    undoPart: function(path) {\n      delete this.parts[path];\n    },\n    saveChanges: function() {\n      var part;\n      for (var path in this.parts) {\n        if (this.parts.hasOwnProperty(path)) {\n          part = this.parts[path];\n          if (part.deleted || !part.xdoc) {\n            this.deleteFile(part.path);\n            this.zip.remove(part.relsPath);\n          } else {\n            this.addFile(part.contentType, part.path, part.xdoc.toXmlString());\n            if (part.relsXdoc) {\n              this.zip.file(part.relsPath.slice(1), part.relsXdoc.toXmlString());\n            } else {\n              this.zip.remove(part.relsPath);\n            }\n          }\n        }\n      }\n      this.parts = {};\n      this.zip.file(\"[Content_Types].xml\", this.ctDoc.toXmlString());\n      return this.zip;\n    },\n    saveToBase64: function() {\n      return this.saveChanges().generate({\n        compression: \"deflate\",\n        type: \"base64\"\n      });\n    },\n    saveToBlob: function() {\n      return this.saveChanges().generate({\n        compression: \"deflate\",\n        type: \"blob\"\n      });\n    },\n    saveToDataURI: function() {\n      return \"data:\" + this.mimetype + \";base64,\" + this.saveToBase64();\n    }\n  };\n  var getStyle = window.getComputedStyle || function(e) {\n    return e.currentStyle;\n  };\n  function leftPad(s, len, c) {\n    c = c || \" \";\n    len = len || 2;\n    while (s.length < len) {\n      s = c + s;\n    }\n    return s;\n  }\n  var colornames = {\n    AQUA: \"00FFFF\",\n    BLACK: \"000000\",\n    BLUE: \"0000FF\",\n    FUCHSIA: \"FF00FF\",\n    GRAY: \"808080\",\n    GREEN: \"008000\",\n    LIME: \"00FF00\",\n    MAROON: \"800000\",\n    NAVY: \"000080\",\n    OLIVE: \"808000\",\n    PURPLE: \"800080\",\n    RED: \"FF0000\",\n    SILVER: \"C0C0C0\",\n    TEAL: \"008080\",\n    WHITE: \"FFFFFF\",\n    YELLOW: \"FFFF00\"\n  };\n  function convertColor(c) {\n    var tem, i = 0;\n    c = c ? c.toString().toUpperCase() : \"\";\n    if (/^#[A-F0-9]{3,6}$/.test(c)) {\n      if (c.length < 7) {\n        var A = c.split(\"\");\n        c = A[1] + A[1] + A[2] + A[2] + A[3] + A[3];\n      } else {\n        c = c.substr(1, 8);\n      }\n      return c;\n    }\n    if (/^[A-Z]+$/.test(c)) {\n      return colornames[c] || \"\";\n    }\n    c = c.match(/\\d+(\\.\\d+)?%?/g) || [];\n    if (c.length < 3 || c.length > 4) {\n      return \"\";\n    }\n    for (i = 0; i < c.length; i++) {\n      tem = c[i];\n      if (tem.indexOf(\"%\") !== -1) {\n        tem = Math.round(parseFloat(tem) * 2.55);\n      } else {\n        tem = parseInt(tem, 10);\n      }\n      if (tem < 0 || tem > 255) {\n        return \"\";\n      } else {\n        c[i] = leftPad(tem.toString(16).toUpperCase(), 2, \"0\");\n      }\n    }\n    if (c.length === 4 && c[3] === \"00\") {\n      return \"\";\n    }\n    return c.slice(0, 3).join(\"\");\n  }\n  function convertStyle(s) {\n    var a = {};\n    if (s.verticalAlign === \"super\") {\n      a.sup = 1;\n    }\n    if (s.verticalAlign === \"sub\") {\n      a.sub = 1;\n    }\n    var i = parseInt(s.fontWeight, 10);\n    if (isNaN(i)) {\n      if (s.fontWeight === \"bold\") {\n        a.b = 1;\n      }\n    } else {\n      if (i >= 700) {\n        a.b = 1;\n      }\n    }\n    if (s.fontStyle === \"italic\") {\n      a.i = 1;\n    }\n    if (s.textDecoration === \"underline\") {\n      a.u = 1;\n    }\n    var color = convertColor(s.color);\n    if (color && color !== \"000000\") {\n      a.color = color;\n    }\n    color = convertColor(s.backgroundColor);\n    if (color && color !== \"FFFFFF\") {\n      a.bgColor = color;\n    }\n    return a;\n  }\n  function Blocker() {\n    this.blocks = [];\n    this.block = null;\n  }\n  Blocker.prototype = {\n    addRun: function(style, text) {\n      var run = {};\n      for (var attr in style) {\n        if (style.hasOwnProperty(attr)) {\n          run[attr] = style[attr];\n        }\n      }\n      run.text = text;\n      var block = this.currentBlock();\n      block.runs.push(run);\n      return run;\n    },\n    currentBlock: function() {\n      if (!this.block) {\n        this.block = {\n          type: \"paragraph\",\n          runs: []\n        };\n      }\n      return this.block;\n    },\n    breakBlock: function(force) {\n      if (this.block || force) {\n        var block = this.currentBlock();\n        this.blocks.push(block);\n        this.block = null;\n        return block;\n      } else if (this.blocks.length) {\n        return this.blocks[this.blocks.length - 1];\n      }\n    },\n    getBlocks: function() {\n      this.breakBlock();\n      return this.blocks;\n    },\n    procNode: function(style, child) {\n      var sblocker;\n      if (child.nodeType === 3) {\n        this.addRun(style, child.nodeValue);\n      } else if (child.nodeType === 1) {\n        var cssStyle = getStyle(child);\n        if (cssStyle.display === \"none\") {\n          return;\n        }\n        var isBlock = cssStyle.display === \"block\";\n        var cstyle = convertStyle(cssStyle);\n        if (isBlock) {\n          this.breakBlock();\n        }\n        if (child.tagName === \"LI\") {\n          this.breakBlock();\n          this.currentBlock().type = \"list-item\";\n          this.procNodes(cstyle, child.childNodes);\n        } else if (child.tagName === \"OL\" || child.tagName === \"UL\") {\n          this.breakBlock();\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"list\",\n            listType: child.tagName.toLowerCase(),\n            blocks: sblocker.getBlocks()\n          });\n        } else if (child.tagName === \"TABLE\") {\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"table\",\n            blocks: sblocker.blocks\n          });\n        } else if (child.tagName === \"TR\") {\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"table-row\",\n            blocks: sblocker.blocks\n          });\n        } else if (child.tagName === \"TD\" || child.tagName === \"TH\") {\n          sblocker = new Blocker();\n          sblocker.procNodes(cstyle, child.childNodes);\n          this.blocks.push({\n            type: \"table-cell\",\n            blocks: sblocker.getBlocks()\n          });\n        } else if (child.tagName === \"A\") {\n          cstyle.link = child.href;\n          this.procNodes(cstyle, child.childNodes);\n        } else if (child.tagName === \"HR\") {\n          this.currentBlock().hr = true;\n          this.breakBlock();\n        } else if (child.tagName === \"BR\") {\n          this.breakBlock();\n        } else if (child.tagName === \"IMG\") {\n          var run = this.addRun(cstyle, \"[\" + (child.alt || child.title || \"IMAGE\") + \"]\");\n          run.link = child.src;\n        } else {\n          this.procNodes(cstyle, child.childNodes);\n        }\n      }\n    },\n    procNodes: function(style, children) {\n      for (var i = 0; i < children.length; i++) {\n        this.procNode(style, children[i]);\n      }\n    }\n  };\n  function convertHtml(html) {\n    var d = document.createElement(\"DIV\");\n    var p = document.head || document.body;\n    p.appendChild(d);\n    d.innerHTML = html;\n    var mblocker = new Blocker();\n    mblocker.procNodes({}, d.childNodes);\n    p.removeChild(d);\n    d = null;\n    return mblocker.getBlocks();\n  }\n  OpenXmlBuilder.convertHtml = convertHtml;\n  relTypes.slideMaster = relTypePrefix + \"slideMaster\";\n  relTypes.slideLayout = relTypePrefix + \"slideLayout\";\n  relTypes.slide = relTypePrefix + \"slide\";\n  contTypes.slide = \"application/vnd.openxmlformats-officedocument.presentationml.slide+xml\";\n  function PPTXBuilder(b64Template, title, created, creator) {\n    XPkg.call(this, b64Template, title, created, creator);\n    this.slideCount = 0;\n    this.presentation = this.getPart(\"/ppt/presentation.xml\");\n    this.sldIdLst = this.presentation.one(\"/p:presentation/p:sldIdLst\");\n    var es = this.sldIdLst.all(\"./p:sldId\");\n    for (var i = 0; i < es.length; i++) {\n      es[i].remove();\n    }\n    this.app = this.getPart(\"/docProps/app.xml\").xdoc;\n    this.slidesProp = this.app.one(\"/ep:Properties/ep:Slides\");\n    this.slidesProp.setValue(\"0\");\n    this.slidesTitlesProp = this.app.all(\"/ep:Properties/ep:HeadingPairs/vt:vector/vt:variant/vt:i4\");\n    this.slidesTitlesProp = this.slidesTitlesProp[this.slidesTitlesProp.length - 1];\n    this.slidesTitlesProp.setValue(\"0\");\n    this.titlesVector = this.app.one(\"/ep:Properties/ep:TitlesOfParts/vt:vector\");\n    this.titlesVector.setAttr(\"size\", \"1\");\n    es = this.titlesVector.all(\"./vt:lpstr\");\n    for (i = 1; i < es.length; i++) {\n      es[i].remove();\n    }\n    var rels = this.presentation.getRelationshipsByRelationshipType(relTypes.slide);\n    var rel, part;\n    for (i = 0; i < rels.length; i++) {\n      rel = rels[i];\n      part = this.getPart(this.fullPath(rel.getAttr(\"Target\"), this.presentation.path));\n      this.presentation.deleteRelationship(rel.relationshipId);\n      part.deleted = true;\n    }\n  }\n  PPTXBuilder.prototype = {\n    mimetype: \"application/vnd.openxmlformats-officedocument.presentationml.presentation\",\n    addSlide: function(title, slideLayoutId) {\n      slideLayoutId = slideLayoutId || 2;\n      this.slideCount++;\n      var slideNum = this.slideCount;\n      var sldId = slideNum + 255;\n      title = title || \"Slide \" + slideNum;\n      var slideUri = \"slides/slide\" + slideNum + \".xml\";\n      var slideLayoutUri = \"slideLayouts/slideLayout\" + slideLayoutId + \".xml\";\n      var slideLayout = this.getPart(\"/ppt/\" + slideLayoutUri);\n      var sldTemplate = slideLayout.xdoc.toXmlString();\n      sldTemplate = sldTemplate.replace(/(<\\/?p:sld)Layout/g, \"$1\");\n      var slide = this.addPart(contTypes.slide, \"/ppt/\" + slideUri, sldTemplate);\n      slide.addRelationship(slide.nextRelationshipId(), relTypes.slideLayout, \"../\" + slideLayoutUri, \"Internal\");\n      var sld = slide.xdoc.root();\n      sld.removeAttr(\"preserve\");\n      sld.removeAttr(\"type\");\n      sld.one(\"p:cSld\").removeAttr(\"name\");\n      var rel = slideLayout.getRelationshipsByRelationshipType(relTypes.slideMaster)[0];\n      var slideMaster = this.getPart(this.fullPath(rel.getAttr(\"Target\"), slideLayout.path));\n      var hf = slideMaster.one(\"//p:hf\");\n      if (hf) {\n        var shapes = slide.all(\"//p:sp\");\n        var ph, phType;\n        for (var i = 0; i < shapes.length; i++) {\n          ph = shapes[i].one(\"./p:nvSpPr/p:nvPr/p:ph\");\n          if (ph) {\n            phType = ph.getAttr(\"type\");\n            if (phType && hf.getAttr(phType) === \"0\") {\n              shapes[i].remove();\n            }\n          }\n        }\n      }\n      var rId = this.presentation.nextRelationshipId();\n      this.presentation.addRelationship(rId, relTypes.slide, slideUri, \"Internal\");\n      this.sldIdLst.add(this.presentation.el(\"p:sldId\", {\n        \"r:id\": rId,\n        id: sldId\n      }));\n      this.slidesProp.setValue(slideNum);\n      this.slidesTitlesProp.setValue(slideNum);\n      this.titlesVector.add(this.app.el(\"vt:lpstr\", title));\n      this.titlesVector.setAttr(\"size\", slideNum + 1);\n      return slide;\n    },\n    contentSlide: function(content, slideLayoutId) {\n      slideLayoutId = slideLayoutId || 2;\n      var title = content.title || content[\"Title 1\"];\n      var slide = this.addSlide(title, slideLayoutId);\n      var shapes = slide.all(\"//p:sp\");\n      for (var i = 0; i < shapes.length; i++) {\n        var spId = shapes[i].one(\"./p:nvSpPr/p:cNvPr\").getAttr(\"name\");\n        var html = content[spId];\n        if (html) {\n          this.pptContent(slide, shapes[i], html);\n        }\n      }\n    },\n    _block: function(slide, txBody, block, listType, level) {\n      if (block.type === \"list\") {\n        listType = block.listType || \"ul\";\n        level = level >= 0 ? level += 1 : 0;\n        this._blocks(slide, txBody, block.blocks, listType, level);\n      } else if (block.type === \"table\") {\n        this._inlineTable(slide, txBody, block);\n      } else if (block.type === \"list-item\") {\n        this._paragraph(slide, txBody, block, listType, level);\n      } else {\n        this._paragraph(slide, txBody, block, null, level);\n      }\n    },\n    _blocks: function(slide, txBody, blocks, listType, level) {\n      for (var i = 0; i < blocks.length; i++) {\n        this._block(slide, txBody, blocks[i], listType, level);\n      }\n    },\n    _runs: function(slide, parent, runs) {\n      var run, r, rPr, t, rId;\n      var lastLink;\n      for (var i = 0; i < runs.length; i++) {\n        run = runs[i];\n        r = slide.el(\"a:r\");\n        lastLink = run.link;\n        if (run.b || run.i || run.u || run.color || run.link) {\n          rPr = slide.el(\"a:rPr\");\n          if (run.b) {\n            rPr.setAttr(\"b\", \"1\");\n          }\n          if (run.i) {\n            rPr.setAttr(\"i\", \"1\");\n          }\n          if (run.u) {\n            rPr.setAttr(\"u\", \"sng\");\n          }\n          if (run.color) {\n            rPr.add(slide.el(\"a:solidFill\").add(slide.el(\"a:srgbClr\", {\n              val: run.color\n            })));\n          }\n          if (run.link) {\n            rId = slide.nextRelationshipId();\n            slide.addRelationship(rId, relTypes.hyperlink, run.link, \"External\");\n            rPr.add(slide.el(\"a:hlinkClick\", {\n              \"r:id\": rId\n            }));\n          }\n          r.add(rPr);\n        }\n        t = slide.el(\"a:t\", run.text);\n        r.add(t);\n        parent.add(r);\n      }\n      if (lastLink) {\n        parent.add(slide.el(\"a:endParaRPr\").add(slide.el(\"a:hlinkClick\", {\n          \"r:id\": \"\"\n        })));\n      }\n    },\n    _paragraph: function(slide, parent, paragraph, listType, level) {\n      var p, pPr;\n      p = slide.el(\"a:p\");\n      if (level >= 0 || listType !== \"ul\") {\n        pPr = slide.el(\"a:pPr\");\n        p.add(pPr);\n        if (level > 0) {\n          pPr.setAttr(\"lvl\", level);\n        }\n        if (listType === \"ol\") {\n          pPr.add(slide.el(\"a:buAutoNum\", {\n            type: \"arabicPeriod\"\n          }));\n        } else if (!listType) {\n          pPr.add(slide.el(\"a:buNone\"));\n        }\n        if (!listType && level >= 0) {\n          p.add(slide.el(\"a:r\").add(slide.el(\"a:t\", \"\t\")));\n        }\n      }\n      this._runs(slide, p, paragraph.runs);\n      parent.add(p);\n    },\n    _inlineTable: function(slide, parent, table, listType, level) {\n      var i, j, cind, cspan, rspan, row, cell;\n      var colspans = {};\n      var spanned = function() {\n        while (colspans[cind]) {\n          cspan = colspans[cind][1] || 1;\n          rspan = colspans[cind][0];\n          if (colspans[cind][0]) {\n            colspans[cind][0] -= 1;\n          } else {\n            delete colspans[cind];\n          }\n          cind += cspan;\n        }\n      };\n      this._paragraph(slide, parent, {\n        runs: [ {\n          u: true,\n          i: true,\n          text: \"Table\"\n        } ]\n      }, listType, level);\n      level = (level || 0) + 1;\n      for (i = 0; i < table.blocks.length; i++) {\n        row = table.blocks[i];\n        this._paragraph(slide, parent, {\n          runs: [ {\n            u: true,\n            i: true,\n            text: \"Row \" + (row + 1)\n          } ]\n        }, null, level);\n        cind = 0;\n        for (j = 0; j < row.blocks.length; j++) {\n          spanned();\n          cell = row.blocks[j];\n          cspan = cell.colspan || 1;\n          rspan = cell.rowspan;\n          this._paragraph(slide, parent, {\n            runs: [ {\n              i: true,\n              text: \"Column\" + (cind + 1)\n            } ]\n          }, null, level + 1);\n          this._blocks(slide, parent, cell, null, level + 1);\n          if (rspan > 1) {\n            colspans[cind] = [ rspan - 1, cspan || 1 ];\n          }\n          cind += cspan;\n        }\n        spanned();\n      }\n    },\n    _table: function(slide, parent, table) {\n      var i, j, k, row, cell, r, c, e, cspan, rspan, cind;\n      var tbl = slide.el(\"a:tbl\");\n      var phTxbody = function() {\n        return slide.el(\"a:txBody\").add(slide.el(\"a:bodyPr\")).add(slide.el(\"a:lstStyle\"));\n      };\n      var phTc = function() {\n        return slide.el(\"a:tc\").add(phTxbody().add(slide.el(\"a:p\"))).add(slide.el(\"a:tcPr\"));\n      };\n      var colspans = {};\n      var spanned = function() {\n        while (colspans[cind]) {\n          cspan = colspans[cind][1] || 1;\n          rspan = colspans[cind][0];\n          var c = phTc().setAttr(\"vMerge\", 1);\n          r.add(c);\n          if (cspan > 1) {\n            c.setAttr(\"gridSpan\", cspan);\n            for (k = 1; k < cspan; k++) {\n              r.add(phTc().setAttr(\"hMerge\", 1).setAttr(\"vMerge\", 1));\n            }\n          }\n          if (colspans[cind][0]) {\n            colspans[cind][0] -= 1;\n          } else {\n            delete colspans[cind];\n          }\n          cind += cspan;\n        }\n      };\n      for (i = 0; i < table.blocks.length; i++) {\n        row = table.blocks[i];\n        r = slide.el(\"a:tr\");\n        cind = 0;\n        for (j = 0; j < row.blocks.length; j++) {\n          spanned();\n          cell = row.blocks[j];\n          cspan = cell.colspan || 1;\n          rspan = cell.rowspan;\n          c = slide.el(\"a:tc\");\n          r.add(c);\n          if (cspan > 1) {\n            c.setAttr(\"gridSpan\", cspan);\n            for (k = 1; k < cspan; k++) {\n              r.add(phTc().setAttr(\"hMerge\", 1));\n            }\n          }\n          if (rspan > 1) {\n            colspans[cind] = [ rspan - 1, cspan || 1 ];\n          }\n          e = phTxbody();\n          c.add(e);\n          this._blocks(e, cell.blocks);\n          e = slide.el(\"a:tcPr\");\n          c.add(e);\n          cind += cspan;\n        }\n        spanned();\n        tbl.add(r);\n      }\n      parent.add(tbl);\n    },\n    pptContent: function(slide, shape, html) {\n      var txBody = shape.one(\"./p:txBody\");\n      var ps = txBody.all(\"./a:p\");\n      for (var j = 0; j < ps.length; j++) {\n        ps[j].remove();\n      }\n      var blocks = convertHtml(html);\n      this._blocks(slide, txBody, blocks);\n    },\n    pptLine: function(slide, shape, html) {\n      var txBody = shape.one(\"./p:txBody\");\n      var ps = txBody.all(\"./a:p\");\n      for (var j = 0; j < ps.length; j++) {\n        ps[j].remove();\n      }\n      var blocks = convertHtml(html);\n      if (blocks.length === 1 && blocks[0].type === \"paragraph\") {\n        var block = blocks[0];\n        this._paragraph(slide, txBody, block);\n      } else {\n        throw \"Content is not a single paragraph\";\n      }\n    },\n    pptTable: function(slide, shape, html) {\n      var graphicFrame = slide.el(\"p:graphicFrame\");\n      var a, b, c, i;\n      a = slide.el(\"p:nvGraphicFramePr\");\n      graphicFrame.add(a);\n      b = shape.one(\"./p:cNvPr\");\n      if (b) {\n        a.add(b);\n      }\n      b = shape.one(\"./p:cNvSpPr\");\n      if (b) {\n        c = slide.el(\"p:cNvGraphicFramePr\");\n        b = b.all(\"./*\");\n        for (i = 0; i < b.length; i++) {\n          c.add(b[i]);\n        }\n        a.add(c);\n      }\n      b = shape.one(\"./p:nvPr\");\n      if (b) {\n        b.add(b);\n      }\n      a = slide.el(\"a:graphic\");\n      graphicFrame.add(a);\n      b = slide.el(\"a:graphicData\").setAttr(\"uri\", \"http://schemas.openxmlformats.org/drawingml/2006/table\");\n      a.add(b);\n      shape.replace(graphicFrame);\n      var blocks = convertHtml(html);\n      if (blocks.length === 1 && blocks[0].type === \"table\") {\n        var block = blocks[0];\n        this._table(slide, b, block);\n      } else {\n        throw \"Content is not a table\";\n      }\n    }\n  };\n  (function() {\n    for (var f in XPkg.prototype) {\n      if (XPkg.prototype.hasOwnProperty(f)) {\n        PPTXBuilder.prototype[f] = XPkg.prototype[f];\n      }\n    }\n  })();\n  OpenXmlBuilder.PPTXBuilder = PPTXBuilder;\n  relTypes.numbering = relTypePrefix + \"numbering\";\n  relTypes.aFChunk = relTypePrefix + \"aFChunk\";\n  contTypes.numbering = \"application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml\";\n  function _valBuild(e, v) {\n    return function(xdoc) {\n      return xdoc.el(e, {\n        \"w:val\": v\n      });\n    };\n  }\n  function DOCXBuilder(b64Template, title, created, creator) {\n    XPkg.call(this, b64Template, title, created, creator);\n    this.doc = this.getPart(\"/word/document.xml\");\n    this.body = this.doc.one(\"/w:document/w:body\");\n    this.sectPr = this.body.one(\"./w:sectPr\");\n    var es = this.body.all(\"./*\");\n    for (var i = 0; i < es.length; i++) {\n      es[i].remove();\n    }\n    if (this.sectPr) {\n      this.body.add(this.sectPr);\n    }\n  }\n  DOCXBuilder.prototype = {\n    mimetype: \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n    rStyleItalic: function(xdoc) {\n      return xdoc.el(\"w:i\");\n    },\n    rStyleBold: function(xdoc) {\n      return xdoc.el(\"w:b\");\n    },\n    rStyleUnderline: _valBuild(\"w:u\", \"single\"),\n    rStyleHyperlink: _valBuild(\"w:rStyle\", \"Hyperlink\"),\n    pStyleNoSpacing: _valBuild(\"w:pStyle\", \"NoSpacing\"),\n    pStyleListParagraph: _valBuild(\"w:pStyle\", \"ListParagraph\"),\n    pStyle: function(name) {\n      return _valBuild(\"w:pStyle\", name);\n    },\n    rStyle: function(name) {\n      if (name === \"Italic\") {\n        return this.rStyleItalic;\n      } else if (name === \"Bold\") {\n        return this.rStyleBold;\n      } else if (name === \"Underline\") {\n        return this.rStyleUnderline;\n      }\n      return _valBuild(\"w:rStyle\", name);\n    },\n    _levelIndent: function(level) {\n      return 720 * (1 + (level || 0));\n    },\n    makeUl: function() {\n      return this.makeList([ {\n        fmt: \"bullet\",\n        fnt: \"Symbol\",\n        txt: \"\"\n      }, {\n        fmt: \"bullet\",\n        fnt: \"Courier New\",\n        txt: \"o\"\n      }, {\n        fmt: \"bullet\",\n        fnt: \"Wingdings\",\n        txt: \"\"\n      } ], 9);\n    },\n    makeOl: function() {\n      return this.makeList([ {\n        fmt: \"decimal\"\n      }, {\n        fmt: \"lowerLetter\"\n      }, {\n        fmt: \"lowerRoman\"\n      } ], 9);\n    },\n    makeOlNum: function() {\n      return this.makeList([ {\n        fmt: \"decimal\"\n      } ], 9);\n    },\n    makeOlHier: function() {\n      return this.makeList([ {\n        fmt: \"decimal\",\n        hier: true\n      } ], 9);\n    },\n    makeList: function(levels, depth) {\n      var numPart = this.getPart(\"/word/numbering.xml\");\n      if (!numPart) {\n        numPart = this.addPart(contTypes.numbering, \"/word/numbering.xml\", docTemplate(\"w:numbering\", null, \"w\"));\n        this.doc.addRelationship(this.doc.nextRelationshipId(), relTypes.numbering, \"numbering.xml\", \"Internal\");\n      }\n      var nsid = Math.random().toString(16).substring(2, 10).toUpperCase();\n      var anumid = numPart.nextId(\"//w:abstractNum\", \"w:abstractNumId\", 0);\n      var listid = numPart.nextId(\"//w:num\", \"w:numId\", 1);\n      var anum = numPart.el(\"w:abstractNum\").setAttr(\"w:abstractNumId\", anumid);\n      anum.add(numPart.el(\"w:nsid\").setAttr(\"w:val\", nsid));\n      anum.add(numPart.el(\"w:multiLevelType\").setAttr(\"w:val\", \"hybridMultilevel\"));\n      var lvl, level, lvlText, hLvlText, idt;\n      depth = depth || levels.length;\n      for (var i = 0; i < depth; i++) {\n        level = levels[i % levels.length];\n        idt = this._levelIndent(i);\n        lvl = numPart.el(\"w:lvl\").setAttr(\"w:ilvl\", i);\n        lvl.add(numPart.el(\"w:start\").setAttr(\"w:val\", \"1\"));\n        lvl.add(numPart.el(\"w:numFmt\").setAttr(\"w:val\", level.fmt));\n        if (level.fmt === \"bullet\") {\n          lvlText = level.txt || \" \";\n          hLvlText = \"\";\n        } else {\n          lvlText = \"%\" + (i + 1) + \".\";\n          hLvlText += lvlText;\n        }\n        lvl.add(numPart.el(\"w:lvlText\").setAttr(\"w:val\", level.heir ? hLvlText : lvlText));\n        lvl.add(numPart.el(\"w:lvlJc\").setAttr(\"w:val\", \"left\"));\n        lvl.add(numPart.el(\"w:pPr\").add(numPart.el(\"w:ind\", {\n          \"w:hanging\": \"360\",\n          \"w:left\": idt\n        })));\n        if (level.fnt) {\n          lvl.add(numPart.el(\"w:rPr\").add(numPart.el(\"w:rFonts\", {\n            \"w:hint\": \"default\",\n            \"w:hAnsi\": level.fnt,\n            \"w:ascii\": level.fnt\n          })));\n        }\n        anum.add(lvl);\n      }\n      var num = numPart.el(\"w:num\").setAttr(\"w:numId\", listid);\n      num.add(numPart.el(\"w:abstractNumId\").setAttr(\"w:val\", anumid));\n      numPart.xdoc.root().add(anum);\n      numPart.xdoc.root().add(num);\n      return listid;\n    },\n    docLine: function(html, pStyle, rStyle) {\n      var seg = convertHtml(html);\n      if (seg.length === 1 && seg[0].type === \"paragraph\") {\n        seg = seg[0];\n        this._paragraph(this.body, this.sectPr, seg, pStyle, rStyle);\n      } else {\n        throw \"Content is too complex\";\n      }\n    },\n    docContent: function(html) {\n      var blocks = convertHtml(html);\n      this._blocks(this.body, this.sectPr, blocks);\n    },\n    docChunk: function(html) {\n      html = \"<html><head></head><body>\" + html + \"</body></html>\";\n      var rId = this.doc.nextRelationshipId();\n      var uri = \"/word/chunk\" + rId + \".html\";\n      this.addFile(\"text/html\", uri, html);\n      this.doc.addRelationship(rId, relTypes.aFChunk, uri, \"Internal\");\n      var chunk = this.doc.el(\"w:altChunk\").setAttr(\"r:id\", rId);\n      this.body.add(chunk, this.sectPr);\n    },\n    _block: function(parent, before, block, listid, level) {\n      var pPrs;\n      if (block.type === \"table\") {\n        this._table(parent, before, block);\n      } else if (block.type === \"list\") {\n        if (!listid) {\n          listid = block.listType === \"ul\" ? this.makeUl() : this.makeOlHier();\n          level = 0;\n        } else {\n          level += 1;\n        }\n        this._blocks(parent, before, block.blocks, listid, level);\n      } else if (block.type === \"list-item\" && listid) {\n        pPrs = this.doc.el(\"w:numPr\");\n        pPrs.add(_valBuild(\"w:ilvl\", level)(this.doc.xdoc));\n        pPrs.add(_valBuild(\"w:numId\", listid)(this.doc.xdoc));\n        this._paragraph(parent, before, block, null, null, pPrs);\n      } else if (listid) {\n        pPrs = this.doc.el(\"w:ind\").setAttr(\"w:left\", this._levelIndent(level));\n        this._paragraph(parent, before, block, this.pStyleListParagraph, null, pPrs);\n      } else {\n        this._paragraph(parent, before, block);\n      }\n    },\n    _blocks: function(parent, before, blocks, listid, level) {\n      for (var i = 0; i < blocks.length; i++) {\n        this._block(parent, before, blocks[i], listid, level);\n      }\n    },\n    _runs: function(parent, runs, rStyle) {\n      var run, r, rPr, t;\n      for (var i = 0; i < runs.length; i++) {\n        run = runs[i];\n        r = this.doc.el(\"w:r\");\n        if (run.b || run.i || run.u || run.color || run.link || rStyle) {\n          rPr = this.doc.el(\"w:rPr\");\n          if (run.link) {\n            if (rStyle) {\n              rPr.add(this.rStyleUnderline(this.doc.xdoc));\n            } else {\n              rPr.add(this.rStyleHyperlink(this.doc.xdoc));\n            }\n          }\n          if (rStyle) {\n            rPr.add(rStyle(this.doc.xdoc));\n          }\n          if (run.b) {\n            rPr.add(this.rStyleBold(this.doc.xdoc));\n          }\n          if (run.i) {\n            rPr.add(this.rStyleItalic(this.doc.xdoc));\n          }\n          if (run.u) {\n            rPr.add(this.rStyleUnderline(this.doc.xdoc));\n          }\n          if (run.color) {\n            rPr.add(_valBuild(\"w:color\", run.color)(this.doc.xdoc));\n          }\n          r.add(rPr);\n        }\n        t = this.doc.el(\"w:t\", run.text);\n        if (/^\\s+|\\s+$/.test(run.text)) {\n          t.setAttr(\"xml:space\", \"preserve\");\n        }\n        r.add(t);\n        if (run.link) {\n          var rId = this.doc.nextRelationshipId();\n          this.doc.addRelationship(rId, relTypes.hyperlink, run.link, \"External\");\n          r = this.doc.el(\"w:hyperlink\").setAttr(\"r:id\", rId).add(r);\n        }\n        parent.add(r);\n      }\n    },\n    _paragraph: function(parent, before, paragraph, pStyle, rStyle, pPrs) {\n      var p, pPr;\n      p = this.doc.el(\"w:p\");\n      if (pStyle || rStyle || pPrs) {\n        pPr = this.doc.el(\"w:pPr\");\n        if (pStyle) {\n          pPr.add(pStyle(this.doc.xdoc));\n        }\n        if (rStyle) {\n          pPr.add(this.doc.el(\"w:rPr\").add(rStyle(this.doc.xdoc)));\n        }\n        if (paragraph.hr) {\n          var hr = this.doc.el(\"w:pBdr\");\n          hr.add(this.doc.el(\"w:bottom\").setAttr(\"w:color\", \"auto\").setAttr(\"w:space\", \"1\").setAttr(\"w:sz\", \"6\").setAttr(\"w:val\", \"single\"));\n          pPr.add(hr);\n        }\n        if (pPrs) {\n          pPr.add(pPrs);\n        }\n        p.add(pPr);\n      }\n      this._runs(p, paragraph.runs, rStyle);\n      parent.add(p, before);\n    },\n    _table: function(parent, before, table) {\n      var i, j, row, cell, r, c, e, cspan, rspan, cind;\n      var tbl = this.doc.el(\"w:tbl\");\n      var colspans = {};\n      var spanned = function() {\n        while (colspans[cind]) {\n          cspan = colspans[cind][1] || 1;\n          rspan = colspans[cind][0];\n          c = this.doc.el(\"w:tc\");\n          e = this.doc.el(\"w:tcPr\");\n          if (cspan > 1) {\n            e.add(this.doc.el(\"w:gridSpan\").setAttr(\"w:val\", cspan));\n          }\n          e.add(this.doc.el(\"w:vMerge\"));\n          c.add(e);\n          c.add(this.doc.el(\"w:p\"));\n          if (colspans[cind][0]) {\n            colspans[cind][0] -= 1;\n          } else {\n            delete colspans[cind];\n          }\n          r.add(c);\n          cind += cspan;\n        }\n      };\n      for (i = 0; i < table.blocks.length; i++) {\n        row = table.blocks[i];\n        r = this.doc.el(\"w:tr\");\n        cind = 0;\n        for (j = 0; j < row.blocks.length; j++) {\n          spanned();\n          c = this.doc.el(\"w:tc\");\n          cspan = cell.colspan || 1;\n          rspan = cell.rowspan;\n          cell = row.blocks[j];\n          e = this.doc.el(\"w:tcPr\");\n          if (cspan > 1) {\n            e.add(this.doc.el(\"w:gridSpan\").setAttr(\"w:val\", cspan));\n          }\n          if (rspan > 1) {\n            colspans[cind] = [ rspan - 1, cspan || 1 ];\n            e.add(this.doc.el(\"w:vMerge\").setAttr(\"w:val\", \"restart\"));\n          }\n          c.add(e);\n          this._blocks(c, cell.blocks);\n          r.add(c);\n          cind += cspan;\n        }\n        spanned();\n        tbl.add(r);\n      }\n      parent.add(tbl, before);\n    }\n  };\n  (function() {\n    for (var f in XPkg.prototype) {\n      if (XPkg.prototype.hasOwnProperty(f)) {\n        DOCXBuilder.prototype[f] = XPkg.prototype[f];\n      }\n    }\n  })();\n  OpenXmlBuilder.DOCXBuilder = DOCXBuilder;\n  if (typeof define === \"function\" && define.amd) {\n    define(function() {\n      return OpenXmlBuilder;\n    });\n  } else if (typeof module === \"object\" && module && typeof module.exports === \"object\" && module.exports) {\n    module.exports = OpenXmlBuilder;\n  } else {\n    window.OpenXmlBuilder = OpenXmlBuilder;\n  }\n})(function() {\n  return this;\n}());"]}